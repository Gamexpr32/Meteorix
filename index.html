<html lang="en"><head>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script><style type="text/css" id="operaUserStyle"></style>

<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><title>Predictive AI â€” Climate, Disasters, Wildlife</title><style>
:root{
  --container:1920px;
  --sans:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  --mono:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
  --radius:16px;
  --gap:18px;
  --dur-in:.15s; /* Faster page transition */
  --dur-out:.1s; /* Faster page transition */
  --ease:cubic-bezier(0.25, 1, 0.5, 1); /* Snappy ease-out quint */
  --home-gap:26px;
  --home-card-pad:26px;
  --home-section-gap:22px;
  --transition-speed: 0.2s; /* Faster theme/element transitions */
}

body[data-theme="dark"] {
  --bg:#0f1115;
  --card:#151823;
  --ink:#e8ecf1;
  --muted:#9aa3ad;
  --accent:#66e3c4;
  --accent2:#7aa7ff;
  --danger:#ff6b6b;
  --shadow:0 12px 40px rgba(0,0,0,.28);
  --search-border:#2a3145;
  --chip-border:#2b3150;
  --gradient-bg: linear-gradient(180deg,#0e1014 0%,#0f1115 100%);
  --gradient-card: linear-gradient(180deg,#141827 0%,#111522 100%);
  --gradient-search: linear-gradient(180deg,#10182a 0%,#0f1523 100%);
  --gradient-search-prefix: linear-gradient(180deg,#0e1426 0%,#0d1322 100%);
  --gradient-chip: linear-gradient(180deg,#0e1426 0%,#0d1322 100%);
  --gradient-special: linear-gradient(135deg,#1a2332,#0f1523);
  --divider-color: #1e2435;
  --menu-hover-bg: #1c2235;
  --logo-gradient: radial-gradient(120% 120% at 20% 20%,var(--accent) 0%,var(--accent2) 70%,#2a2f3a 100%);
  --map-filter: brightness(0.8) contrast(1.2);
  --bot-message-bg: #1e2435;
  --user-message-bg: #0e1426;
  --info-box-bg: #0a0e16;
  --info-box-border: #2a3145;
  --chat-overlay-bg: rgba(15, 17, 21, 0.7);
}

body[data-theme="light"] {
  --bg: #f0f2f5;
  --card: #ffffff;
  --ink: #1d2129;
  --muted: #606770;
  --accent: #008a69;
  --accent2: #4267B2;
  --danger: #d93025;
  --shadow: 0 8px 24px rgba(0,0,0,0.1);
  --search-border: #ccd0d5;
  --chip-border: #dcdfe3;
  --gradient-bg: var(--bg);
  --gradient-card: var(--card);
  --gradient-search: #e8eaf0;
  --gradient-search-prefix: #dde0e4;
  --gradient-chip: #e7f3ff;
  --gradient-special: #f8f9fa;
  --divider-color: #e4e6eb;
  --menu-hover-bg: #f0f2f5;
  --logo-gradient: radial-gradient(120% 120% at 20% 20%, var(--accent) 0%, var(--accent2) 70%, #e4e6eb 100%);
  --map-filter: none;
  --bot-message-bg: #f0f2f5;
  --user-message-bg: #e7f3ff;
  --info-box-bg: #f8f9fa;
  --info-box-border: #e4e6eb;
  --chat-overlay-bg: rgba(240, 242, 245, 0.7);
}

*{box-sizing:border-box}html,body{height:100%}
body{
  margin:0;
  background:var(--gradient-bg);
  color:var(--ink);
  font-family:var(--sans);
  transition: background-color var(--transition-speed), color var(--transition-speed);
  will-change: background-color, color; /* Promote for smoother transitions */
}
a{color:var(--accent);text-decoration:none}
header{max-width:var(--container);margin:32px auto 10px;padding:0 24px;display:flex;align-items:center;justify-content:space-between; position: relative;}
.brand{display:flex;gap:14px;align-items:center}
.logo{
    width:40px;height:40px;border-radius:10px;
    background:var(--logo-gradient);
    box-shadow:0 8px 22px rgba(102,227,196,.35);
    transition: background var(--transition-speed), transform 0.2s var(--ease);
    will-change: transform;
}
.logo:hover { transform: scale(1.1); }
.brand h1{font-size:18px;margin:0;font-weight:600;letter-spacing:.4px}
nav{display:flex;gap:22px;flex-wrap:wrap; align-items: center;}nav a{color:var(--muted);font-size:16px; transition: color var(--transition-speed), transform 0.2s var(--ease); will-change: color, transform;}
nav a:hover{color:var(--ink); transform: translateY(-2px);}
nav a.active { font-weight: 600; color: var(--ink); }
.header-actions { display: flex; align-items: center; gap: 10px; }


.container{max-width:var(--container);margin:26px auto 48px;padding:0 24px}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:var(--gap)}.grid-home{display:grid;grid-template-columns:repeat(12,1fr);gap:var(--home-gap)}
.span-12{grid-column:span 12}.span-9{grid-column:span 9}.span-8{grid-column:span 8}.span-7{grid-column:span 7}.span-6{grid-column:span 6}.span-5{grid-column:span 5}.span-4{grid-column:span 4}.span-3{grid-column:span 3}
.card{
    background:var(--gradient-card);
    border:1px solid var(--search-border);
    border-radius:16px;padding:24px;box-shadow:var(--shadow);
    transition: background-color var(--transition-speed), border-color var(--transition-speed), transform 0.2s var(--ease);
    will-change: transform, background-color, border-color;
}
.card:hover { transform: translateY(-4px); }
.card-home{padding:var(--home-card-pad)}
.card,.card *{overflow-wrap:anywhere;word-break:break-word}pre.mono{white-space:pre-wrap;overflow-wrap:anywhere;word-break:break-word;max-width:100%}
h2{margin:0 0 8px;font-size:28px}h3{margin:0 0 8px;font-size:18px} h4, h5, h6 { margin: 0; } .subtitle{color:var(--muted);margin:0 0 14px;font-size:16px}
.btn{
    background: var(--card); color: var(--ink); border: 1px solid var(--search-border); padding:12px 16px;border-radius:12px;
    font-size:15px;cursor:pointer; 
    transition: background-color var(--transition-speed), border-color var(--transition-speed), transform 0.15s var(--ease);
    will-change: transform, background-color, border-color;
}
.btn:hover{
    border-color:#3a4360;
    transform: scale(1.03);
}
.btn:active { transform: scale(0.98); }
body[data-theme="light"] .btn:hover { border-color: #aeb4bb; background: #e2e4e8; }

.btn.primary{
    background:linear-gradient(90deg,#66e3c4,#7aa7ff);
    color:#0e131b;border:none
}
body[data-theme="light"] .btn.primary { background: linear-gradient(90deg, var(--accent), var(--accent2)); color: #fff; }

.mono{font-family:var(--mono)}.muted{color:var(--muted)}
.divider{height:1px;background:var(--divider-color);margin:14px 0 16px; transition: background-color var(--transition-speed);}
.page{display:none;opacity:0; transition: opacity var(--dur-in) var(--ease), transform var(--dur-in) var(--ease); will-change: opacity, transform; transform: translateY(10px);}
.page.active{display:block;opacity:1; transform: translateY(0);}
.page.fading-out{opacity:0; transform: translateY(-10px); transition-duration: var(--dur-out);}

.home-section + .home-section{margin-top:var(--home-section-gap)}
.searchbar{
    display:flex;align-items:center;gap:10px;flex-wrap:wrap;position:relative;width:100%;
    background:var(--gradient-search);border:1px solid var(--search-border);
    border-radius:14px;padding:10px 12px;box-shadow:var(--shadow);
    transition: background-color var(--transition-speed), border-color var(--transition-speed);
}
.searchbar input{flex:1 1 320px;min-width:220px;border:none;outline:none;background:transparent;color:var(--ink);font-size:15px;padding:8px 10px}
.searchbar .prefix{
    display:flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:10px;
    background:var(--gradient-search-prefix);border:1px solid var(--search-border);color:#a9c7ff;font-size:14px;
    transition: background-color var(--transition-speed), color var(--transition-speed), border-color var(--transition-speed);
}
body[data-theme="light"] .searchbar .prefix { color: var(--muted); }

.searchbar .suffix{display:flex;align-items:center;gap:8px}
.chip{
    display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;
    background:var(--gradient-chip);border:1px solid var(--chip-border);color:#d6e2ff;font-size:12px;
    transition: background-color var(--transition-speed), color var(--transition-speed), border-color var(--transition-speed);
}
body[data-theme="light"] .chip { color: var(--accent2); }

.menu{
    position:absolute;top:54px;left:0;right:0;background:var(--card);border:1px solid var(--search-border);
    border-radius:12px;box-shadow:var(--shadow);max-height:300px;overflow:auto;z-index:20;display:none;
    transition: background-color var(--transition-speed), border-color var(--transition-speed);
}
.menu.open{display:block}.menu button{width:100%;text-align:left;background:transparent;border:none;color:var(--ink);padding:10px 12px;cursor:pointer;font-size:14px}
.menu button:hover { background-color: var(--menu-hover-bg); }
.earth-wrap{position:relative;width:100%;height:520px;min-height:320px;border:1px solid #222739;border-radius:16px;background:#02040a;overflow:hidden}
#globeMount{position:absolute;inset:0}
.earth-hud{position:absolute;top:10px;right:10px;padding:6px 10px;font-size:12px;color:#bcd5ff;border:1px solid #2a3145;border-radius:999px;background:#0f1523a0;backdrop-filter:blur(4px);z-index:3}
.earth-legend{position:absolute;left:10px;bottom:10px;padding:8px 10px;font-size:12px;color:#b3c2d6;border:1px solid #2a3145;border-radius:12px;background:#0f1523a0;backdrop-filter:blur(4px);z-index:3}

/* Special card overrides */
[style*="linear-gradient(135deg,#1a2332,#0f1523)"] {
  background: var(--gradient-special) !important;
  border-color: var(--search-border) !important;
  transition: background var(--transition-speed), border-color var(--transition-speed);
}
#projectionInfo { background: var(--gradient-special) !important; border-color: var(--search-border) !important; }

/* Theme-proof chart text */
.chart-container { color: var(--ink); }
body[data-theme='light'] .ct-label { color: var(--ink); }
body[data-theme='light'] .ct-grid { stroke: rgba(0,0,0,0.1); }

/* ============================================= */
/* =========== NEW CHAT PAGE STYLES ============ */
/* ============================================= */
#chat-container {
    position: relative;
    padding: 0;
    overflow: hidden;
    background-size: cover;
    background-position: center;
    transition: background-image 0.5s ease-in-out;
}
#chat-container::before {
    content: '';
    position: absolute;
    inset: 0;
    background-color: var(--chat-overlay-bg);
    backdrop-filter: blur(8px);
    transition: background-color 0.2s;
    z-index: 1;
}
#chat-content {
    position: relative;
    z-index: 2;
    padding: 24px;
}

#chat-window {
    height: 50vh;
    min-height: 400px;
    border: 1px solid var(--search-border);
    border-radius: var(--radius);
    padding: 16px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin-bottom: 16px;
    background: transparent; /* Transparent to see the overlay */
}
.chat-message {
    padding: 10px 14px;
    border-radius: 14px;
    max-width: 85%;
    line-height: 1.6;
    font-size: 15px;
    opacity: 0;
    transform: translateY(10px);
    animation:-fade-in 0.3s var(--ease) forwards;
    display: flex;
    gap: 10px;
    align-items: flex-start;
}
@keyframes -fade-in { to { opacity: 1; transform: translateY(0); } }

.user-message {
    background-color: var(--user-message-bg);
    border: 1px solid var(--chip-border);
    align-self: flex-end;
    border-bottom-right-radius: 4px;
    color: var(--ink);
}
.bot-message {
    background-color: var(--bot-message-bg);
    border: 1px solid var(--search-border);
    align-self: flex-start;
    border-bottom-left-radius: 4px;
    color: var(--muted);
}
.bot-avatar {
    font-size: 20px;
    line-height: 1.5;
    padding-top: 2px;
}
.data-nugget {
    display: inline-block;
    background-color: var(--info-box-bg);
    border: 1px solid var(--info-box-border);
    border-radius: 6px;
    padding: 2px 8px;
    font-size: 12px;
    font-family: var(--mono);
    color: var(--accent2);
    margin: 0 3px;
    white-space: nowrap;
}
.data-nugget.bad { color: var(--danger); }
.data-nugget.good { color: var(--accent); }


#chat-input-container {
    display: flex;
    gap: 10px;
}
#chat-input {
    flex-grow: 1;
    border: 1px solid var(--search-border);
    background-color: var(--card);
    border-radius: 12px;
    padding: 12px 16px;
    font-size: 15px;
    color: var(--ink);
    outline: none;
    transition: border-color 0.2s;
}
#chat-input:focus {
    border-color: var(--accent);
}
#typing-indicator {
    font-style: italic;
    color: var(--muted);
    padding: 4px 16px;
    display: none;
    opacity: 0;
    transition: opacity 0.2s;
    min-height: 24px;
}
#typing-indicator.visible {
    display: block;
    opacity: 1;
}
.chat-prompts-container {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 16px;
}
.chat-prompt-btn {
    background: var(--info-box-bg);
    border: 1px solid var(--info-box-border);
    color: var(--muted);
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
}
.chat-prompt-btn:hover {
    background: var(--menu-hover-bg);
    color: var(--ink);
    border-color: var(--accent2);
}

/* SIGN IN PAGE STYLES */
.signin-card {
    grid-column: 4 / 10;
    margin: 32px auto;
    text-align: center;
}
@media(max-width: 900px) {
    .signin-card { grid-column: span 12; }
}
.form-group {
    text-align: left;
    margin-bottom: 16px;
}
.form-group label {
    display: block;
    margin-bottom: 6px;
    font-size: 14px;
    color: var(--muted);
}
.form-group input, .form-group select {
    width: 100%;
    padding: 12px 14px;
    font-size: 15px;
    border-radius: 12px;
    border: 1px solid var(--search-border);
    background-color: var(--gradient-search);
    color: var(--ink);
}
.divider-or {
    display: flex;
    align-items: center;
    text-align: center;
    color: var(--muted);
    font-size: 13px;
    margin: 24px 0;
}
.divider-or::before, .divider-or::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid var(--divider-color);
}
.divider-or:not(:empty)::before { margin-right: .5em; }
.divider-or:not(:empty)::after { margin-left: .5em; }

.social-btn {
    display:inline-flex; 
    align-items:center; 
    gap:12px; 
    width: 100%;
    justify-content: center;
    margin-bottom: 12px;
    padding: 12px 24px; 
    font-size: 16px;
}

#worldMapInner { width:100%; height:100%; min-height:320px; border-radius:16px; }

#habitatMap {
    height: 400px;
    width: 100%;
    border-radius: var(--radius);
    border: 1px solid var(--search-border);
    margin-top: 16px;
    background-color: #f0f2f5; /* Light bg for map */
}
#habitatMap .leaflet-tile-pane {
    filter: var(--map-filter);
}
#auth-container { display: contents; }

/* ============================================= */
/* ========= NEW SPECIES UI STYLES ============= */
/* ============================================= */
.result-placeholder {
    text-align: center;
    padding: 40px 20px;
    color: var(--muted);
    border-radius: 12px;
    background: var(--gradient-search-prefix);
    border: 1px dashed var(--search-border);
}
.result-placeholder > div {
    font-size: 24px;
    margin-bottom: 12px;
}

.species-card {
    padding: 0;
    overflow: hidden;
}
.species-card .card-content {
    padding: 24px;
}

.species-header {
    padding: 20px 24px;
    background: var(--gradient-special);
    border-bottom: 1px solid var(--search-border);
}
.species-header h4 {
    font-size: 22px;
    margin: 0 0 4px;
    color: var(--ink);
    font-weight: 600;
}
.species-header .rank {
    font-size: 14px;
    color: var(--accent);
    font-family: var(--mono);
}

.species-summary {
    font-size: 15px;
    line-height: 1.7;
    color: var(--muted);
    margin-bottom: 16px;
}

.info-box {
    padding: 16px;
    background: var(--info-box-bg);
    border-radius: 12px;
    border: 1px solid var(--info-box-border);
}
.info-box h5 {
    margin: 0 0 10px;
    font-size: 14px;
    color: var(--accent2);
    font-weight: 600;
}
.info-box p, .info-box ul {
    font-size: 14px;
    color: var(--muted);
    margin: 0;
    padding: 0;
    list-style: none;
    line-height: 1.8;
}

.tag-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}
.tag-list li {
    background: var(--gradient-chip);
    border: 1px solid var(--chip-border);
    color: #d6e2ff;
    padding: 5px 12px;
    border-radius: 999px;
    font-size: 13px;
}
body[data-theme="light"] .tag-list li { color: var(--accent2); }

.climate-survival-card {
    border-left-width: 4px;
}
.climate-survival-card h5 {
    font-size: 18px;
    margin-bottom: 16px;
    color: var(--ink);
}

.climate-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 12px;
    text-align: center;
}
.climate-stats-grid > div {
    background: var(--info-box-bg);
    border: 1px solid var(--info-box-border);
    border-radius: 12px;
    padding: 16px;
}
.climate-stats-grid h6 {
    margin: 0 0 8px;
    font-size: 13px;
    color: var(--muted);
    font-weight: 500;
}
.climate-stats-grid .stat-value {
    font-size: 20px;
    font-weight: 600;
    color: var(--ink);
    margin-bottom: 4px;
}
.climate-stats-grid .stat-delta {
    font-size: 12px;
    font-weight: 500;
}
.delta-good { color: var(--accent); }
.delta-bad { color: var(--danger); }

.extinction-summary {
    padding: 16px;
    background: var(--info-box-bg);
    border-left: 4px solid var(--accent2);
    border-radius: 8px;
    font-size: 14px;
    line-height: 1.6;
    color: var(--muted);
}
.extinction-summary strong {
    color: var(--accent);
}

.trait-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 14px;
}
.trait-item { font-size: 14px; }
.trait-item .trait-name { display: flex; justify-content: space-between; margin-bottom: 6px; color: var(--muted); }
.trait-item .trait-score { color: var(--ink); font-weight: 600; }
.progress-bar { width: 100%; height: 8px; background-color: var(--info-box-bg); border-radius: 999px; overflow: hidden; border: 1px solid var(--search-border); }
.progress-fill { height: 100%; border-radius: 999px; background-color: var(--accent); transition: width 0.5s var(--ease); }

#dnaResult .dna-summary p { font-size: 14px; color: var(--muted); line-height: 1.6; margin: 16px 0 0; padding-top: 16px; border-top: 1px solid var(--divider-color); }
#dnaResult .dna-summary strong { color: var(--accent2); }

/* FLOATING ACTION BUTTON (FAB) MENU */
.fab-container {
    position: fixed;
    bottom: 24px;
    right: 24px;
    z-index: 100;
}
.fab-menu {
    list-style: none;
    padding: 0;
    margin: 0 0 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
}
.fab-menu-item {
    opacity: 0;
    transform: translateY(20px) scale(0.8);
    transition: opacity 0.2s var(--ease), transform 0.2s var(--ease);
}
.fab-container.active .fab-menu-item {
    opacity: 1;
    transform: translateY(0) scale(1);
}
/* Staggered animation delay */
.fab-container.active .fab-menu-item:nth-child(1) { transition-delay: 0.14s; }
.fab-container.active .fab-menu-item:nth-child(2) { transition-delay: 0.12s; }
.fab-container.active .fab-menu-item:nth-child(3) { transition-delay: 0.10s; }
.fab-container.active .fab-menu-item:nth-child(4) { transition-delay: 0.08s; }
.fab-container.active .fab-menu-item:nth-child(5) { transition-delay: 0.06s; }
.fab-container.active .fab-menu-item:nth-child(6) { transition-delay: 0.04s; }


.fab-menu-item a {
    display: flex;
    align-items: center;
    gap: 12px;
    background: var(--card);
    border: 1px solid var(--search-border);
    padding: 10px 16px;
    border-radius: 12px;
    box-shadow: var(--shadow);
    color: var(--muted);
    font-size: 15px;
    font-weight: 500;
    white-space: nowrap;
    text-decoration: none;
}
.fab-menu-item a:hover {
    background: var(--menu-hover-bg);
    color: var(--ink);
}
.fab-menu-item a.active {
    font-weight: 600;
    color: var(--accent);
    border-color: var(--accent);
}
#fab-toggle {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    font-size: 24px;
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: var(--shadow);
    transition: transform 0.2s var(--ease), background 0.2s;
}
.fab-container.active #fab-toggle {
    transform: rotate(45deg);
}

/* GIBS MAP CONTROLS */
.gibs-controls {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    align-items: center;
    margin-bottom: 16px;
}
.gibs-controls .control-group {
    display: flex;
    align-items: center;
    gap: 8px;
}
.gibs-controls label {
    font-size: 14px;
    color: var(--muted);
}
.gibs-controls input[type="date"], .gibs-controls select {
    background: var(--gradient-search-prefix);
    border: 1px solid var(--search-border);
    color: var(--ink);
    border-radius: 8px;
    padding: 6px 10px;
    font-size: 14px;
}


/* TIME MIRROR PAGE */
#time-slider {
    width: 100%;
    -webkit-appearance: none;
    appearance: none;
    height: 8px;
    background: var(--search-border);
    outline: none;
    border-radius: 999px;
    opacity: 0.7;
    transition: opacity .2s;
}
#time-slider:hover { opacity: 1; }
#time-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    background: var(--accent);
    cursor: pointer;
    border-radius: 50%;
    border: 3px solid var(--card);
}
#time-slider::-moz-range-thumb {
    width: 24px;
    height: 24px;
    background: var(--accent);
    cursor: pointer;
    border-radius: 50%;
    border: 3px solid var(--card);
}
#summary-content, #species-content {
    font-size: 14px;
    line-height: 1.7;
    color: var(--muted);
}
#species-content ul { list-style: none; padding: 0; margin: 0; }
#species-content li { padding: 6px 0; border-bottom: 1px solid var(--divider-color); }
#species-content li:last-child { border-bottom: none; }
.status-thriving { color: var(--accent); }
.status-stable { color: var(--muted); }
.status-declining { color: var(--danger); }


@media (min-width: 901px) {
    .fab-container { display: none; }
}
@media (max-width:900px){
    .span-12,.span-9,.span-8,.span-7,.span-6,.span-5,.span-4,.span-3{grid-column:span 12}
    .grid-home{gap:22px}
    .card-home{padding:22px}
    .searchbar input{flex-basis:100%}
    nav { display: none; }
}

</style></head>
<body data-theme="dark" class="">
<script>
  (function() {
    try {
      const theme = localStorage.getItem('theme') || 'dark';
      document.body.setAttribute('data-theme', theme);
    } catch (e) {
      // localStorage is not available
    }
  })();
</script>

<header>
    <div class="brand"><img src="data:image/jpeg;base64,data:image/jpeg;base64,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" class="logo-img"><h1>Meteorix</h1></div>
    <nav>
        <a href="#home" id="link-home" class="active">Home</a>
        <a href="#species-wildlife" id="link-species-wildlife" class="">Species &amp; Wildlife</a>
        <a href="#environment" id="link-environment" class="">Environment</a>
        <a href="#disasters" id="link-disasters" class="">Disasters</a>
        <a href="#time-mirror" id="link-time-mirror" class="">Time Mirror</a>
        <a href="#chat" id="link-chat">Chat</a>
        <div id="auth-container"><a href="#signin" id="link-signin">Sign In</a></div>
    </nav>
    <div class="header-actions">
        <button id="theme-toggle" class="btn">â˜€ï¸</button>
    </div>
</header>

<main id="home" class="page container active" aria-labelledby="home-title" style="display: block;">
<section class="grid-home home-section" style="align-items:stretch">


</section>

<section class="grid-home home-section">
  <div class="card card-home span-12">
    <h2 id="home-title">Predictive AI for climate, disasters, and wildlife</h2>
    <p class="subtitle">Forecast local weather, receive early warnings, and protect species â€” in a calm interface designed for fast, lowâ€‘bandwidth decisions.</p>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px">
      <a class="btn" href="#species-wildlife">Find a species</a>
      <a class="btn" href="#species-wildlife">Check animals</a>
    </div>
    <div class="divider"></div>
    <h3>Search by place â€” Current Weather &amp; 7-Day Forecast</h3>
    <p class="subtitle">Type a city, state, district, village, or landmark. Get current conditions plus daily forecasts for the next week.</p>
    <div class="searchbar" role="search" aria-label="Place search">
      <div class="prefix">ðŸ™ï¸</div>
      <input id="placeQueryHome" type="search" placeholder="e.g., Alappuzha, Kerala, India" autocomplete="off">
      <div class="suffix">
        <button id="searchPlaceHome" class="btn primary">Search Weather</button>
        <span class="chip"><span>Geocoder</span>
          <select id="geoSourceHome" class="btn" style="padding:6px 10px">
            <option value="builtin" selected="">Builtâ€‘in</option>
            <option value="global">Global (Proxy)</option>
          </select>
        </span>
      </div>
      <div id="placeMenuHome" class="menu"></div>
    </div>
    <div class="divider"></div>
    <div id="placeResultHome" style="margin-top:16px">
      <div id="currentWeatherHome" class="card" style="margin-bottom:16px;display:none">
        <h3>Current Weather</h3>
        <div id="weatherLevelBadge" style="display:inline-block;margin-bottom:12px"></div>
        <div id="currentWeatherContent" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:12px"></div>
      </div>
      <div id="forecastWeatherHome" class="card" style="display:none">
        <h3>7-Day Forecast</h3>
        <div id="forecastContent" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-top:12px"></div>
      </div>
      <pre id="placeStatusHome" class="mono">Enter a place name and click Search Weather to see current conditions and 7-day forecast.</pre>
    </div>
    <div class="divider"></div>
    <h3>Interactive World Map</h3>
    <section id="global-weather-map" style="text-align:center; padding: 20px;">
      <iframe width="100%" height="600" src="https://embed.windy.com/embed2.html?lat=0&amp;lon=0&amp;zoom=2&amp;level=surface&amp;overlay=wind&amp;menu=&amp;message=true&amp;marker=&amp;calendar=&amp;pressure=true&amp;type=map&amp;location=coordinates&amp;detail=&amp;metricWind=km/h&amp;metricTemp=%C2%B0C" frameborder="0" style="border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);"></iframe>
    </section>
  </div>
</section>
</main>

<main id="location" class="page container" aria-labelledby="location-title">
<section class="grid">
  <div class="card span-8">
    <h2 id="location-title">Search by place</h2>
    <p class="subtitle">Type a city, state, district, village, or landmark. Global (Proxy) uses your backend; India fallback covers deep localities offline.</p>
    <div class="searchbar" role="search" aria-label="Place search">
      <div class="prefix">ðŸ™ï¸</div>
      <input id="placeQuery" type="search" placeholder="e.g., Alappuzha, Kerala, India" autocomplete="off">
      <div class="suffix">
        <button id="searchPlace" class="btn primary">Search</button>
        <span class="chip"><span>Geocoder</span>
          <select id="geoSource" class="btn" style="padding:6px 10px">
            <option value="builtin" selected="">Builtâ€‘in</option>
            <option value="global">Global (Proxy)</option>
          </select>
        </span>
        <span class="chip"><span>Weather</span>
          <select id="locSource" class="btn" style="padding:6px 10px">
            <option value="builtin" selected="">Builtâ€‘in</option>
            <option value="external">External</option>
          </select>
        </span>
      </div>
      <div id="placeMenu" class="menu"></div>
    </div>
    <div class="divider"></div>
    <pre id="placeResult" class="mono">Enter a place name and click Search to see weather data.</pre>
  </div>
  <div class="card span-4">
    <h3>India tips</h3>
    <ul style="margin:8px 0 0; padding-left:18px">
      <li>Try district or tehsil for rural areas.</li>
      <li>Use Global (Proxy) for exhaustive coverage.</li>
    </ul>
  </div>
</section>
</main>

<main id="species-wildlife" class="page container" aria-labelledby="species-wildlife-title" style="display: none;">
<section class="grid">
  <div class="card span-12">
    <h2 id="species-wildlife-title">Species &amp; Wildlife</h2>
    <p class="subtitle">Look up species information, assess local risks, and evaluate climate survival for animals.</p>
  </div>
</section>

<!-- ==================================================== -->
<!-- ============== UNIFIED SEARCH BAR ================== -->
<!-- ==================================================== -->
<section class="grid" style="margin-top:var(--home-section-gap)">
    <div class="card span-12">
      <h3>Unified Species Search</h3>
      <p class="subtitle">Search for a species by common or scientific name to populate all analysis modules below.</p>
      <div class="searchbar" role="search" aria-label="Unified Species Search">
        <div class="prefix">ðŸ¾</div>
        <input id="unifiedSpeciesQuery" type="search" placeholder="e.g., Panthera tigris, Snow Leopard, Arctic Fox" autocomplete="off">
        <div class="suffix">
          <button id="unifiedSearchBtn" class="btn primary">Search All</button>
        </div>
        <div id="unifiedSpeciesMenu" class="menu"></div>
      </div>
    </div>
</section>


<section class="grid" style="margin-top:var(--home-section-gap)">
  <div class="card span-8 species-card">
    <div id="speciesResult">
        <div class="species-header">
            <h4>Panthera tigris tigris</h4>
            <div class="rank">SUBSPECIES</div>
        </div>
        <div class="card-content">
            <p class="species-summary">The tiger is a large cat and a member of the genus Panthera native to Asia. It has a powerful, muscular body with a large head and paws, a long tail and orange fur with black, mostly vertical stripes. It is traditionally classified into nine recent subspecies, though some recognise only two subspecies, mainland Asian tigers and the island tigers of the Sunda Islands. <a href="https://en.wikipedia.org/wiki/Tiger" target="_blank" rel="noopener">Source: Wikipedia</a></p>
            <div class="grid" style="gap: 18px;">
                <div class="span-7 info-box">
                    <h5>Taxonomy</h5>
                    <p>Animalia â†’ Chordata â†’ Mammalia â†’ Carnivora â†’ Felidae â†’ Panthera</p>
                </div>
                <div class="span-5 info-box">
                    <h5>Common Names</h5>
                    <ul class="tag-list"><li>Bengal Tiger [eng]</li><li>Bengal tiger [eng]</li><li>Bengal tiger [eng]</li><li>Bengal tiger [eng]</li></ul>
                </div>
            </div>
        </div>
    </div>
  </div>
  <div class="card span-4">
    <h3>Species Lookup</h3>
    <p class="subtitle">Includes taxonomy, summary, and vernacular names from GBIF and Wikipedia.</p>
    <div class="divider"></div>
    <ul style="margin:8px 0 0; padding-left:18px; line-height: 1.8; color: var(--muted); font-size: 14px;">
      <li>Taxonomy: kingdom â†’ species</li>
      <li>Common names</li>
      <li>Wikipedia summary</li>
      <li>Distribution notes</li>
    </ul>
  </div>
</section>

<section class="grid" style="margin-top:var(--home-section-gap)">
  <div class="card span-5">
    <h3>Animals â€” Climate Survival</h3>
    <p class="subtitle">Evaluates a species' tolerance against current local climate conditions.</p>
    <div class="divider"></div>
     <div id="animalResult">
            <div class="card climate-survival-card" style="border-left-color: var(--accent);">
                <div style="padding: 16px;">
                    <h5>Status: Stable</h5>
                    <div class="climate-stats-grid">
                        <div>
                            <h6>Temperature</h6>
                            <div class="stat-value">15.1<span class="muted">Â°C</span></div>
                            <div class="stat-delta delta-good">0.0Â°C</div>
                        </div>
                        <div>
                            <h6>Humidity</h6>
                            <div class="stat-value">100<span class="muted">%</span></div>
                            <div class="stat-delta delta-bad">15.0%</div>
                        </div>
                         <div>
                            <h6>Wind</h6>
                            <div class="stat-value">1.1<span class="muted">m/s</span></div>
                            <div class="stat-delta delta-good">0.0m/s</div>
                        </div>
                    </div>
                </div>
            </div></div>
  </div>
  <div class="card span-7">
     <h3>Tolerance Map (Demo)</h3>
    <p class="subtitle">Define ideal climate ranges for species evaluation.</p>
     <div class="divider"></div>
    <details><summary class="muted">View/edit tolerance map</summary>
<pre class="mono" id="toleranceJson" contenteditable="true" style="white-space:pre-wrap; max-height: 200px; overflow: auto;">{
  "dog":{"alias":["canis lupus familiaris","canis familiaris"],"tempC":[20,26],"rh":[30,70],"windMS":[0,12]},
  "cat":{"alias":["felis catus","felis silvestris catus"],"tempC":[20,27],"rh":[30,70],"windMS":[0,12]},
  "human":{"alias":["homo sapiens"],"tempC":[20,24],"rh":[30,60],"windMS":[0,12]},
  "african elephant":{"alias":["loxodonta africana"],"tempC":[10,30],"rh":[30,80],"windMS":[0,10]},
  "snow leopard":{"alias":["panthera uncia"],"tempC":[-20,10],"rh":[20,70],"windMS":[0,12]},
  "bengal tiger":{"alias":["panthera tigris tigris"],"tempC":[10,32],"rh":[40,85],"windMS":[0,10]},
  "arctic fox":{"alias":["vulpes lagopus"],"tempC":[-50,5],"rh":[20,80],"windMS":[0,15]},
  "desert tortoise":{"alias":["gopherus agassizii"],"tempC":[15,35],"rh":[10,40],"windMS":[0,8]}
}
</pre>
<button id="saveTolerance" class="btn" style="margin-top: 10px;">Save tolerance map</button>
</details>
  </div>
</section>

<section class="grid" style="margin-top:var(--home-section-gap)">
  <div class="card span-12">
    <h3>Animal Voice Stress Analysis</h3>
    <p class="subtitle">Upload an audio file of an animal sound to analyze its emotional state for stress, pain, or distress.</p>
    <div class="searchbar" role="search" aria-label="Animal voice analysis">
      <div class="prefix">ðŸŽ™ï¸</div>
      <input type="file" id="animalSoundUpload" accept="audio/*" style="flex:1 1 auto;">
      <div class="suffix">
        <button id="analyzeSoundBtn" class="btn primary">Analyze Voice</button>
      </div>
    </div>

    


 


 





  <meta charset="UTF-8">
  <title>Animal Stress Analyzer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f1115;
      color: #e8ecf1;
      padding: 40px;
    }
    h2 {
      color: #66e3c4;
    }
    .btn {
      background: linear-gradient(90deg, #66e3c4, #7aa7ff);
      color: #0e131b;
      border: none;
      padding: 12px 20px;
      border-radius: 12px;
      font-size: 16px;
      cursor: pointer;
    }
    .btn:hover {
      transform: scale(1.05);
    }
    #audioPlayback {
      margin-top: 20px;
      display: none;
    }
    .status {
      margin-top: 10px;
      font-size: 14px;
      color: #9aa3ad;
    }
    .result-box {
      margin-top: 20px;
      padding: 16px;
      border: 1px solid #2a3145;
      border-radius: 12px;
      background: #151823;
    }
  </style>



  
  <p>Record animal sounds to identify the species and assess stress indicators.</p>
  <button id="recordBtn" class="btn">ðŸŽ™ï¸ Start Recording</button>
  <div class="status" id="statusText">Analysis failed.</div>
  <audio id="audioPlayback" controls="" src="blob:null/f8f9d5f5-7d1a-4f9a-afe2-648ddcc719df" style="display: block;"></audio>

  <div id="analysisResult" class="result-box" style="display:none;">
    <h3>ðŸ” Analysis Result</h3>
    <p><strong>Species:</strong> <span id="speciesName">â€”</span></p>
    <p><strong>Stress Level:</strong> <span id="stressLevel">â€”</span></p>
    <p><strong>Habitat:</strong> <span id="habitat">â€”</span></p>
    <p><strong>Conservation Status:</strong> <span id="status">â€”</span></p>
  </div>

  <script>
    let mediaRecorder;
    let audioChunks = [];

    const recordBtn = document.getElementById('recordBtn');
    const audioPlayback = document.getElementById('audioPlayback');
    const statusText = document.getElementById('statusText');

    const speciesName = document.getElementById('speciesName');
    const stressLevel = document.getElementById('stressLevel');
    const habitat = document.getElementById('habitat');
    const status = document.getElementById('status');
    const analysisResult = document.getElementById('analysisResult');

    recordBtn.addEventListener('click', async () => {
      if (!mediaRecorder || mediaRecorder.state === 'inactive') {
        try {
          const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
          mediaRecorder = new MediaRecorder(stream);
          audioChunks = [];

          mediaRecorder.ondataavailable = event => {
            audioChunks.push(event.data);
          };

          mediaRecorder.onstop = () => {
            const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
            const audioUrl = URL.createObjectURL(audioBlob);
            audioPlayback.src = audioUrl;
            audioPlayback.style.display = 'block';
            statusText.textContent = 'Analyzing audio...';

            sendAudioForAnalysis(audioBlob);
          };

          mediaRecorder.start();
          recordBtn.textContent = 'â¹ï¸ Stop Recording';
          statusText.textContent = 'Recording...';
        } catch (err) {
          alert('Microphone access denied or unavailable.');
          statusText.textContent = 'Microphone access error.';
        }
      } else {
        mediaRecorder.stop();
        recordBtn.textContent = 'ðŸŽ™ï¸ Start Recording';
      }
    });

    function sendAudioForAnalysis(blob) {
      const formData = new FormData();
      formData.append('audio', blob, 'recording.webm');

      fetch('/analyze-audio', {
        method: 'POST',
        body: formData
      })
      .then(res => res.json())
      .then(data => {
        speciesName.textContent = data.species || 'Unknown';
        stressLevel.textContent = data.stress || 'Unknown';
        habitat.textContent = data.habitat || 'Unknown';
        status.textContent = data.status || 'Unknown';
        analysisResult.style.display = 'block';
        statusText.textContent = 'Analysis complete.';
      })
      .catch(err => {
        console.error(err);
        statusText.textContent = 'Analysis failed.';
      });
    }
  </script>


</div>
</section>

<section class="grid" style="margin-top:var(--home-section-gap)">
  <div class="card span-12">
    <h3>Species Extinction Timeline Simulator</h3>
    <p class="subtitle">Predicts a 20-year survival timeline based on simulated climate and habitat stress.</p>
    <div class="divider"></div>
    <div id="extinctionResultContainer" style="display: block;">
      <div style="position:relative;height:320px;margin-bottom:12px">
        <canvas id="extinctionChart" style="display: block; box-sizing: border-box; height: 320px; width: 1343px;" height="400" width="1679"></canvas>
      </div>
      <div id="extinctionTimelineResult">
            <div class="grid" style="gap: 12px; margin-bottom: 16px;">
                <div class="span-12 info-box">
                    <h5>Primary Threat Factors Simulated</h5>
                    <ul class="tag-list">
                        <li>General Environmental Stress</li>
                    </ul>
                     
                </div>
            </div>
            <div class="extinction-summary" style="border-left-color: var(--accent);">
                <strong>STABLE OUTLOOK:</strong> While facing pressures, the species shows resilience in this simulation. Continued monitoring and proactive conservation are recommended to maintain this stability.
            </div></div>
    </div>
     <div id="extinctionPlaceholder" style="display: none;"><div class="result-placeholder"><div>â³</div>Simulating 20-year timeline for bengal tiger...</div></div>
  </div>
</section>

<section class="grid" style="margin-top:var(--home-section-gap)">
    <div class="card span-12">
        <h3>DNA â†’ Habitat Suitability Visualizer</h3>
        <p class="subtitle">Simulates how a species' genetic adaptations match current and future environmental conditions.</p>
        <div class="divider"></div>
        <div id="dnaResultContainer" style="display: block;">
            <div style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:16px;">
                <button id="dnaViewCurrent" class="btn primary">Current Climate</button>
                <button id="dnaViewFuture" class="btn">Projected Climate 2050</button>
            </div>
             <div class="grid" style="gap: 18px;">
                <div class="span-5" id="dnaResult">
        <div class="info-box">
            <h5>Genomic Profile</h5>
            <ul class="trait-list">
                
                    <li class="trait-item">
                        <div class="trait-name">
                            <span>Generalist Adaptability</span>
                            <span class="trait-score">54.5%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 54.5%; background-color: #cccccc;"></div>
                        </div>
                    </li>
                
                    <li class="trait-item">
                        <div class="trait-name">
                            <span>Thermo-Regulation</span>
                            <span class="trait-score">18.2%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 18.2%; background-color: #ff9966;"></div>
                        </div>
                    </li>
                
                    <li class="trait-item">
                        <div class="trait-name">
                            <span>Hydro-Resilience</span>
                            <span class="trait-score">18.2%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 18.2%; background-color: #66e3c4;"></div>
                        </div>
                    </li>
                
                    <li class="trait-item">
                        <div class="trait-name">
                            <span>Cryo-Adaptation</span>
                            <span class="trait-score">9.1%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 9.1%; background-color: #7aa7ff;"></div>
                        </div>
                    </li>
                
            </ul>
            <div class="dna-summary">
                <p><strong>Basis:</strong> No specific keywords found; assuming a generalist profile.</p>
                <p><strong>Analysis (Current):</strong> The species' genomic profile indicates a strong adaptation to its primary habitat conditions.</p>
            </div>
        </div></div>
                <div class="span-7">
                    <div id="habitatMap" class="leaflet-container leaflet-touch leaflet-retina leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" tabindex="0" style="position: relative;"><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(-342.991px, -256px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 17; transform: translate3d(-621px, -717px, 0px) scale(2);"></div><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(-207px, -239px, 0px) scale(1);"><img alt="" src="https://a.basemaps.cartocdn.com/light_nolabels/6/47/25@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(414px, 278px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/light_nolabels/6/47/26@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(414px, 534px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/light_nolabels/6/46/25@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(158px, 278px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/light_nolabels/6/48/25@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(670px, 278px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/light_nolabels/6/46/26@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(158px, 534px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/light_nolabels/6/48/26@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(670px, 534px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/light_nolabels/6/45/25@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-98px, 278px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/light_nolabels/6/49/25@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(926px, 278px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/light_nolabels/6/45/26@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-98px, 534px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/light_nolabels/6/49/26@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(926px, 534px, 0px); opacity: 1;"></div></div></div><div class="leaflet-pane leaflet-overlay-pane"><svg pointer-events="none" class="leaflet-zoom-animated" width="0" height="0" viewBox="343 256 0 0" style="transform: translate3d(343px, 256px, 0px);"><g><path class="leaflet-interactive" stroke="#7aa7ff" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#7aa7ff" fill-opacity="0.4" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#cccccc" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#cccccc" fill-opacity="0.4" fill-rule="evenodd" d="M0 0"></path></g></svg></div><div class="leaflet-pane leaflet-shadow-pane"></div><div class="leaflet-pane leaflet-marker-pane"></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(12168px, 6617px, 0px) scale(32);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#" title="Zoom in" role="button" aria-label="Zoom in" aria-disabled="false"><span aria-hidden="true">+</span></a><a class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button" aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">âˆ’</span></a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com" title="A JavaScript library for interactive maps"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"></path><path fill="#FFD500" d="M0 4h12v3H0z"></path><path fill="#E0BC00" d="M0 7h12v1H0z"></path></svg> Leaflet</a> <span aria-hidden="true">|</span> Â© OpenStreetMap contributors Â© CARTO</div></div></div><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(-387px, -199px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" src="https://c.basemaps.cartocdn.com/light_nolabels/2/1/1@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(131px, 1px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/light_nolabels/2/2/1@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(387px, 1px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/light_nolabels/2/1/0@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(131px, -255px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/light_nolabels/2/2/0@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(387px, -255px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/light_nolabels/2/1/2@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(131px, 257px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/light_nolabels/2/2/2@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(387px, 257px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/light_nolabels/2/0/1@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-125px, 1px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/light_nolabels/2/3/1@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(643px, 1px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/light_nolabels/2/0/0@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-125px, -255px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/light_nolabels/2/3/0@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(643px, -255px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/light_nolabels/2/0/2@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-125px, 257px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/light_nolabels/2/3/2@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(643px, 257px, 0px); opacity: 1;"></div></div></div><div class="leaflet-pane leaflet-overlay-pane"><svg pointer-events="none" class="leaflet-zoom-animated" width="0" height="0" viewBox="387 199 0 0" style="transform: translate3d(387px, 199px, 0px);"><g><path class="leaflet-interactive" stroke="#cccccc" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#cccccc" fill-opacity="0.4" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#cccccc" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#cccccc" fill-opacity="0.4" fill-rule="evenodd" d="M0 0"></path></g></svg></div><div class="leaflet-pane leaflet-shadow-pane"></div><div class="leaflet-pane leaflet-marker-pane"></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(512px, 454px, 0px) scale(2);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#" title="Zoom in" role="button" aria-label="Zoom in" aria-disabled="false"><span aria-hidden="true">+</span></a><a class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button" aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">âˆ’</span></a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com" title="A JavaScript library for interactive maps"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"></path><path fill="#FFD500" d="M0 4h12v3H0z"></path><path fill="#E0BC00" d="M0 7h12v1H0z"></path></svg> Leaflet</a> <span aria-hidden="true">|</span> Â© OpenStreetMap contributors Â© CARTO</div></div></div></div>
                </div>
            </div>
        </div>
        <div id="dnaPlaceholder" style="display: none;"><div class="result-placeholder"><div>â³</div>Analyzing genomic markers for "bengal tiger"...</div></div>
    </div>
</section>
</main>

<main id="environment" class="page container" aria-labelledby="environment-title" style="display: none; opacity: 1; transform: translateY(0px);">
<section class="grid">
  <div class="card span-12">
    <h2 id="environment-title">Environmental Preservation &amp; Climate Trends</h2>
    <p class="subtitle">Interactive analysis of global warming, temperature trends, and future climate projections based on real-world data.</p>
  </div>
</section>

<section class="grid" style="margin-top:var(--home-section-gap)">
  <div class="card span-12">
    <h3>Interactive Location Search</h3>
    <p class="subtitle">Enter a location, then select a data overlay to view on the map.</p>
    <div class="searchbar" role="search" aria-label="Environment map search">
      <div class="prefix">ðŸ“</div>
      <input id="envMapQuery" type="search" placeholder="e.g., Mount Everest, Paris, Amazon Rainforest" autocomplete="off">
      <div class="suffix">
        <button id="searchEnvMap" class="btn primary">Search</button>
      </div>
    </div>
    <div id="envMapStatus" class="muted" style="min-height: 20px; margin: 12px 4px; font-size: 14px;">Showing results for: "mumbai"</div>
    <div class="divider"></div>
    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 16px;">
        <button id="overlay-fire" class="btn">ðŸ”¥ Fire Hazard</button>
        <button id="overlay-wind" class="btn">ðŸ’¨ Wind Speed</button>
        <button id="overlay-air" class="btn">â˜ï¸ Air Quality</button>
        <button id="overlay-clear" class="btn">âŒ Clear Overlay</button>
    </div>
    <iframe id="env-map-iframe" src="https://maps.google.com/maps?q=mumbai&amp;t=m&amp;z=8&amp;ie=UTF8&amp;iwloc=&amp;output=embed" width="100%" height="600" style="border:0; border-radius: var(--radius);" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
    </iframe>
  </div>
</section>

<section class="grid" style="margin-top:var(--home-section-gap)">
  <div class="card span-12">
    <h3>Global Temperature Anomaly (1880-2024)</h3>
    <p class="subtitle">Historical temperature changes relative to 1951-1980 baseline. Click and drag to zoom into specific time periods.</p>
    <div style="position:relative;height:320px;margin-bottom:12px">
      <canvas id="tempAnomalyChart" style="display: block; box-sizing: border-box; height: 0px; width: 0px;" height="0" width="0"></canvas>
    </div>
    <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
      <button class="btn" onclick="resetChartZoom('tempAnomaly')">Reset Zoom</button>
      <button class="btn" onclick="setChartRange('tempAnomaly', 1880, 1950)">1880-1950</button>
      <button class="btn" onclick="setChartRange('tempAnomaly', 1950, 2000)">1950-2000</button>
      <button class="btn" onclick="setChartRange('tempAnomaly', 2000, 2024)">2000-2024</button>
    </div>
    <div style="padding:10px;background:rgba(102,227,196,0.08);border-radius:8px;font-size:13px;color:#9aa3ad">
      <strong style="color:#66e3c4">2024 Status:</strong> +1.55Â°C above pre-industrial levels (warmest year on record)
    </div>
  </div>
</section>

<section class="grid" style="margin-top:var(--home-section-gap)">
  <div class="card span-12">
    <h3>COâ‚‚ Concentration Trends (1960-2024)</h3>
    <p class="subtitle">Atmospheric carbon dioxide levels in parts per million. Scroll to zoom, drag to pan.</p>
    <div style="position:relative;height:320px;margin-bottom:12px">
      <canvas id="co2Chart" style="display: block; box-sizing: border-box; height: 0px; width: 0px;" height="0" width="0"></canvas>
    </div>
    <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
      <button class="btn" onclick="resetChartZoom('co2')">Reset Zoom</button>
      <button class="btn" onclick="setChartRange('co2', 1960, 1990)">1960-1990</button>
      <button class="btn" onclick="setChartRange('co2', 1990, 2010)">1990-2010</button>
      <button class="btn" onclick="setChartRange('co2', 2010, 2024)">2010-2024</button>
    </div>
    <div style="padding:10px;background:rgba(255,107,107,0.08);border-radius:8px;font-size:13px;color:#9aa3ad">
      <strong style="color:#ff6b6b">2024 Level:</strong> ~424 ppm (highest in human history)
    </div>
  </div>
</section>

<section class="grid" style="margin-top:var(--home-section-gap)">
  <div class="card span-12">
    <h3>Temperature Projections (2025-2100)</h3>
    <p class="subtitle">Future warming scenarios based on different emission pathways. Interactive comparison of climate futures.</p>
    <div style="display:flex;gap:12px;margin-bottom:16px;flex-wrap:wrap">
      <button class="btn" onclick="updateProjection('ssp126')">SSP1-2.6 (Low)</button>
      <button class="btn" onclick="updateProjection('ssp245')">SSP2-4.5 (Medium)</button>
      <button class="btn" onclick="updateProjection('ssp370')">SSP3-7.0 (High)</button>
      <button class="btn" onclick="updateProjection('ssp585')">SSP5-8.5 (Very High)</button>
      <button class="btn primary" onclick="showAllProjections()">Compare All</button>
    </div>
    <div style="position:relative;height:360px;margin-bottom:16px">
      <canvas id="projectionChart" style="display: block; box-sizing: border-box; height: 0px; width: 0px;" height="0" width="0"></canvas>
    </div>
    <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
      <button class="btn" onclick="resetChartZoom('projection')">Reset Zoom</button>
    </div>
    <div id="projectionInfo" style="padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145">
      <h4 style="margin:0 0 8px;font-size:16px;color:#e8ecf1">SSP2-4.5 (Medium Emissions Scenario)</h4>
      <p style="margin:0;font-size:14px;color:#9aa3ad;line-height:1.6">
        Intermediate pathway where emissions decline moderately. Global warming reaches approximately <strong style="color:#ffcc66">+2.7Â°C by 2100</strong>. 
        This scenario assumes gradual implementation of climate policies and some renewable energy transition.
      </p>
    </div>
  </div>
</section>
</main>

<main id="disasters" class="page container" aria-labelledby="disaster-title" style="display: none;">
<section class="grid">
  <div class="card span-12">
    <h2 id="disaster-title">Global Disaster Monitoring &amp; Prediction</h2>
    <p class="subtitle">Real-time multi-hazard alerts, disaster predictions, location status, and wildlife impact assessment.</p>
    
    <div style="display:flex;gap:12px;flex-wrap:wrap;margin-bottom:20px">
      <button id="loadAllGlobalDisasters" class="btn primary">ðŸŒ Load All Global Disasters</button>
      <button id="loadDisasterPredictions" class="btn">ðŸ”® Show Predictions</button>
    </div>
    
    <div class="searchbar" role="search" aria-label="Location search for disaster status" style="margin-bottom:20px">
      <div class="prefix">ðŸ“</div>
      <input id="disasterLocationQuery" type="search" placeholder="Check disaster status for any location (e.g., California, Mumbai, Tokyo)" autocomplete="off">
      <div class="suffix">
        <button id="searchDisasterLocation" class="btn primary">Check Status</button>
        <span class="chip"><span>Radius</span>
          <select id="alertRadius" class="btn" style="padding:6px 10px">
            <option value="100">100 km</option>
            <option value="250" selected="">250 km</option>
            <option value="500">500 km</option>
            <option value="1000">1000 km</option>
          </select>
        </span>
      </div>
      <div id="disasterLocationMenu" class="menu"></div>
    </div>
    
    <div class="divider"></div>
    
    <div id="locationDisasterStatus" style="display:none; margin-bottom: 20px;"></div>
    <div id="disasterPredictions" style="display:none; margin-bottom: 20px;"></div>
    <div id="wildlifeImpactAssessment" style="display:none; margin-bottom: 20px;"></div>
    
    <div id="alertsContainer" style="margin-top:16px"></div>
    <div id="capStatus" style="text-align: center; padding: 40px 20px; color: var(--muted);">
      <div style="font-size:48px;margin-bottom:16px">ðŸ“¡</div>
      <h3 style="margin:0 0 8px;color:var(--ink)">Disaster Feed</h3>
      <p style="margin:0;font-size:15px">Use the buttons or search bar above to load disaster data.</p>
    </div>
  </div>
</section>


</main>


<!-- ============================================= -->
<!-- ============== NEW TIME MIRROR PAGE ========= -->
<!-- ============================================= -->
<main id="time-mirror" class="page container" aria-labelledby="time-mirror-title" style="display: none;">
    <section class="grid">
        <div class="card span-12">
            <h2 id="time-mirror-title">Time Mirror â€“ Future Simulation Mode</h2>
            <p class="subtitle">A time mirror, not a static projection. Slide the timeline to see an AI-generated simulation of a location decades from now. Try searching for "Arctic" or "Amazon".</p>
            <div class="divider"></div>
            
            <div class="searchbar" style="margin-bottom: 16px;">
                <div class="prefix">ðŸ“</div>
                <input id="timeMirrorLocation" type="search" placeholder="e.g., Sundarbans, Arctic, Amazon" value="Sundarbans, India" autocomplete="off">
                <div class="suffix">
                    <button id="runTimeMirrorSearch" class="btn primary">Simulate</button>
                </div>
            </div>

            <div class="form-group">
                <label for="time-slider">Simulation Year: <span id="slider-year-label" style="font-weight: bold; color: var(--accent);">2025</span></label>
                <input type="range" id="time-slider" min="2025" max="2100" value="2025" step="5">
            </div>
            
            <div class="divider"></div>

            <div id="simulation-results" class="grid" style="gap: var(--gap);">
                <div class="span-8">
                    <div id="simulation-map" style="width: 100%; height: 450px; border-radius: var(--radius); border: 1px solid var(--search-border); background: rgb(0, 0, 0); position: relative;" class="leaflet-container leaflet-touch leaflet-retina leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" tabindex="0"><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(-165px, 0px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" src="https://b.basemaps.cartocdn.com/dark_nolabels/8/190/111@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(177px, 18px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/dark_nolabels/8/191/111@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(433px, 18px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/dark_nolabels/8/190/110@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(177px, -238px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/dark_nolabels/8/191/110@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(433px, -238px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/dark_nolabels/8/190/112@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(177px, 274px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/dark_nolabels/8/191/112@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(433px, 274px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/dark_nolabels/8/189/111@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-79px, 18px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/dark_nolabels/8/192/111@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(689px, 18px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/dark_nolabels/8/189/110@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-79px, -238px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/dark_nolabels/8/192/110@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(689px, -238px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/dark_nolabels/8/189/112@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-79px, 274px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/dark_nolabels/8/192/112@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(689px, 274px, 0px); opacity: 1;"></div></div><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/111/190.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(177px, 18px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/111/191.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(433px, 18px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/110/190.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(177px, -238px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/110/191.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(433px, -238px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/112/190.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(177px, 274px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/112/191.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(433px, 274px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/111/189.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(-79px, 18px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/111/192.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(689px, 18px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/110/189.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(-79px, -238px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/110/192.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(689px, -238px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/112/189.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(-79px, 274px, 0px);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/112/192.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(689px, 274px, 0px);"></div></div></div><div class="leaflet-pane leaflet-overlay-pane"><svg pointer-events="none" class="leaflet-zoom-animated" width="734" height="538" viewBox="104 -45 734 538" style="transform: translate3d(104px, -45px, 0px);"><g><path class="leaflet-interactive" stroke="rgba(102, 227, 196, 0.6)" stroke-opacity="1" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" fill="rgba(102, 227, 196, 0.6)" fill-opacity="0" fill-rule="evenodd" d="M325 361L325 -33L507 -33L507 361z"></path></g></svg></div><div class="leaflet-pane leaflet-shadow-pane"></div><div class="leaflet-pane leaflet-marker-pane"></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(48934px, 28622px, 0px) scale(128);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#" title="Zoom in" role="button" aria-label="Zoom in" aria-disabled="false"><span aria-hidden="true">+</span></a><a class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button" aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">âˆ’</span></a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com" title="A JavaScript library for interactive maps"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"></path><path fill="#FFD500" d="M0 4h12v3H0z"></path><path fill="#E0BC00" d="M0 7h12v1H0z"></path></svg> Leaflet</a> <span aria-hidden="true">|</span> Â© CARTO, NASA GIBS</div></div></div><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(-471px, -224px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" src="https://b.basemaps.cartocdn.com/dark_nolabels/8/190/111@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(177px, 18px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/dark_nolabels/8/191/111@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(433px, 18px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/dark_nolabels/8/190/110@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(177px, -238px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/dark_nolabels/8/191/110@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(433px, -238px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/dark_nolabels/8/190/112@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(177px, 274px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/dark_nolabels/8/191/112@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(433px, 274px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/dark_nolabels/8/189/111@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-79px, 18px, 0px); opacity: 1;"><img alt="" src="https://a.basemaps.cartocdn.com/dark_nolabels/8/192/111@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(689px, 18px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/dark_nolabels/8/189/110@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-79px, -238px, 0px); opacity: 1;"><img alt="" src="https://c.basemaps.cartocdn.com/dark_nolabels/8/192/110@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(689px, -238px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/dark_nolabels/8/189/112@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-79px, 274px, 0px); opacity: 1;"><img alt="" src="https://b.basemaps.cartocdn.com/dark_nolabels/8/192/112@2x.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(689px, 274px, 0px); opacity: 1;"></div></div><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/111/190.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(177px, 18px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/111/191.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(433px, 18px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/110/190.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(177px, -238px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/110/191.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(433px, -238px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/112/190.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(177px, 274px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/112/191.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(433px, 274px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/111/189.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(-79px, 18px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/111/192.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(689px, 18px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/110/189.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(-79px, -238px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/110/192.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(689px, -238px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/112/189.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(-79px, 274px, 0px); opacity: 1;"><img alt="" src="//gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_CorrectedReflectance_TrueColor/default/2024-01-01/GoogleMapsCompatible_Level9/8/112/192.jpg" class="leaflet-tile" style="width: 256px; height: 256px; transform: translate3d(689px, 274px, 0px); opacity: 1;"></div></div></div><div class="leaflet-pane leaflet-overlay-pane"><svg pointer-events="none" class="leaflet-zoom-animated" width="0" height="0" viewBox="471 224 0 0" style="transform: translate3d(471px, 224px, 0px);"><g><path class="leaflet-interactive" stroke="rgba(102, 227, 196, 0.6)" stroke-opacity="1" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" fill="rgba(102, 227, 196, 0.6)" fill-opacity="0" fill-rule="evenodd" d="M471 224L471 224z"></path></g></svg></div><div class="leaflet-pane leaflet-shadow-pane"></div><div class="leaflet-pane leaflet-marker-pane"></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(48934px, 28622px, 0px) scale(128);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#" title="Zoom in" role="button" aria-label="Zoom in" aria-disabled="false"><span aria-hidden="true">+</span></a><a class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button" aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">âˆ’</span></a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com" title="A JavaScript library for interactive maps"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"></path><path fill="#FFD500" d="M0 4h12v3H0z"></path><path fill="#E0BC00" d="M0 7h12v1H0z"></path></svg> Leaflet</a> <span aria-hidden="true">|</span> Â© CARTO, NASA GIBS</div></div></div></div>
                    
                </div>
                <div class="span-4">
                    <div id="simulation-details" class="info-box" style="height: 100%;">
                        <h5>Key Environmental Changes</h5>
                        <div id="summary-content"><ul style="list-style: 'ðŸŒ¡ï¸ '; padding-left: 20px;"><li>Avg. Temperature: <strong style="color:var(--danger)">+0.0Â°C</strong></li><li style="list-style: 'ðŸ’§ ';">Sea Level Rise: <strong style="color:var(--accent2)">+0.00m</strong></li><li style="list-style: 'ðŸŒ¿ ';">Mangrove Health: <strong style="color:var(--accent)">Stable</strong></li></ul></div>
                        <div class="divider"></div>
                        <h5>Predicted Dominant Species</h5>
                        <div id="species-content"><ul><li>Bengal Tiger - <span class="status-stable">Stable</span></li><li>Saltwater Crocodile - <span class="status-stable">Stable</span></li><li>Spotted Deer - <span class="status-stable">Stable</span></li><li>Mangrove Pitta - <span class="status-declining">Declining</span></li><li>Jellyfish - <span class="status-thriving">Thriving</span></li></ul></div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>


<!-- ============================================= -->
<!-- ============== NEW CHAT PAGE ================ -->
<!-- ============================================= -->
<main id="chat" class="page container" aria-labelledby="chat-title" style="display: none;">
    <section class="grid">
        <div id="chat-container" class="card span-12" style="background-image: none;">
            <div id="chat-content">
                <h2 id="chat-title">Ecosystem Chat</h2>
                <p class="subtitle">Speak directly with the planet's vital ecosystems. Ask them how they're feeling about their health, the species they support, or the threats they face.</p>
                
                <div class="form-group" style="margin-bottom: 16px;">
                    <label for="ecosystem-selector">Choose an Ecosystem to Speak With:</label>
                    <select id="ecosystem-selector" class="btn" style="width: 100%; padding: 12px; font-size: 15px; background: var(--gradient-search-prefix); border: 1px solid var(--search-border); color: var(--ink);">
                        <option value="">-- Select an Ecosystem --</option>
                        <option value="rainforest">Amazon Rainforest</option>
                        <option value="tundra">Arctic Tundra</option>
                        <option value="reef">Great Barrier Reef</option>
                        <option value="desert">Sahara Desert</option>
                    </select>
                </div>

                <div id="chat-window"><div class="chat-message bot-message"><div class="bot-avatar">ðŸŒŽ</div><div>Select an ecosystem above to begin a conversation.</div></div></div>
                <div id="typing-indicator">Typing...</div>
                <div id="chat-input-container">
                    <input type="text" id="chat-input" placeholder="Select an ecosystem to begin" autocomplete="off" disabled="">
                    <button id="send-chat-btn" class="btn primary" disabled="">Send</button>
                </div>
                 <div id="chat-prompts" class="chat-prompts-container"></div>
            </div>
        </div>
    </section>
</main>


<!-- ============================================= -->
<!-- ============= NEW SIGN-IN PAGE ============== -->
<!-- ============================================= -->
<main id="signin" class="page container" aria-labelledby="signin-title" style="display: none;">
    <section class="grid">
        <div class="card signin-card">
            <h2 id="signin-title">Sign In</h2>
            <p class="subtitle">Access the AI Chat Assistant by signing in.</p>
            
            <div class="form-group">
                <label for="email-input">Email</label>
                <input type="email" id="email-input" placeholder="user@example.com">
            </div>
            <div class="form-group">
                <label for="password-input">Password</label>
                <input type="password" id="password-input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
            </div>

            <button id="email-signin-btn" class="btn primary" style="width: 100%; margin-top: 8px;">Sign In</button>
            
            <div class="divider-or">or</div>

            <button id="google-signin-btn" class="btn social-btn">
                <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path d="M17.64 9.20455C17.64 8.56682 17.5827 7.95273 17.4764 7.36364H9V10.845H13.8436C13.635 11.9705 13.0009 12.9232 12.0477 13.5618V15.8195H14.9564C16.6582 14.2527 17.64 11.9459 17.64 9.20455Z" fill="#4285F4"></path><path d="M9 18C11.43 18 13.4673 17.1941 14.9564 15.8195L12.0477 13.5618C11.2418 14.1014 10.2109 14.4205 9 14.4205C6.96182 14.4205 5.23727 13.0182 4.61727 11.1818H1.59591V13.5005C3.06591 16.2023 5.79591 18 9 18Z" fill="#34A853"></path><path d="M4.61727 11.1818C4.41636 10.5618 4.30909 9.89818 4.30909 9.20455C4.30909 8.51091 4.41636 7.84727 4.61727 7.22727V4.90864H1.59591C0.947727 6.16591 0.523636 7.62591 0.523636 9.20455C0.523636 10.7832 0.947727 12.2432 1.59591 13.5005L4.61727 11.1818Z" fill="#FBBC05"></path><path d="M9 3.57955C10.3214 3.57955 11.5077 4.03364 12.4405 4.92545L15.0218 2.34409C13.4632 0.891818 11.4259 0 9 0C5.79591 0 3.06591 1.79773 1.59591 4.90864L4.61727 7.22727C5.23727 5.39091 6.96182 3.57955 9 3.57955Z" fill="#EA4335"></path></svg>
                <span>Sign in with Google</span>
            </button>
             <button id="github-signin-btn" class="btn social-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
                <span>Sign in with GitHub</span>
            </button>
            
            <pre id="signin-status" class="mono" style="text-align: center; color: var(--danger); min-height: 20px;"></pre>
        </div>
    </section>
</main>

<div class="fab-container">
    <ul class="fab-menu">
        <li class="fab-menu-item"><a href="#home" id="fab-link-home" class="active">Home</a></li>
        <li class="fab-menu-item"><a href="#species-wildlife" id="fab-link-species-wildlife" class="">Species</a></li>
        <li class="fab-menu-item"><a href="#environment" id="fab-link-environment" class="">Environment</a></li>
        <li class="fab-menu-item"><a href="#disasters" id="fab-link-disasters" class="">Disasters</a></li>
        <li class="fab-menu-item"><a href="#time-mirror" id="fab-link-time-mirror" class="">Time Mirror</a></li>
        <li class="fab-menu-item"><a href="#chat" id="fab-link-chat">Chat</a></li>
    </ul>
    <button id="fab-toggle" class="btn primary">+</button>
</div>


<footer style="text-align:center;padding:20px;color:#9aa3ad;font-size:14px">
<div>Â© 2025 Predictive AI Lab</div>
<div><a href="#species-wildlife">Species &amp; Wildlife</a> Â· <a href="#environment">Environment</a> Â· <a href="#disasters">Disasters</a> Â· <a href="#chat">Chat</a></div>
</footer>

<script>
// =============================================
// =========== AUTHENTICATION LOGIC ============
// =============================================

let authState = {
    isSignedIn: false,
    user: null,
    intendedRoute: null // To store where the user wanted to go
};

function saveAuthState() {
    sessionStorage.setItem('authState', JSON.stringify(authState));
}

function loadAuthState() {
    const storedState = sessionStorage.getItem('authState');
    if (storedState) {
        authState = JSON.parse(storedState);
    }
}

function updateNavForAuth() {
    const authContainer = document.getElementById('auth-container');
    if (!authContainer) return;

    if (authState.isSignedIn) {
        const name = authState.user.name.split(' ')[0]; // Show first name
        authContainer.innerHTML = `
            <span style="color: var(--muted); cursor: default; font-size: 15px;">${name}</span>
            <a href="#" id="signout-link" style="color: var(--accent2);">Sign Out</a>
        `;
        document.getElementById('signout-link').addEventListener('click', handleSignOut);
    } else {
        authContainer.innerHTML = `<a href="#signin" id="link-signin">Sign In</a>`;
    }
}

function handleSignIn(method, name = 'Demo User') {
    const statusEl = document.getElementById('signin-status');
    statusEl.style.color = 'var(--accent2)';
    statusEl.textContent = `Signing in with ${method}...`;

    // Simulate a successful Authentication
    setTimeout(() => {
        authState.isSignedIn = true;
        authState.user = { name: name, method: method };
        saveAuthState();
        updateNavForAuth();

        const destination = authState.intendedRoute || 'chat';
        authState.intendedRoute = null; 
        saveAuthState();
        
        history.pushState(null, '', '#' + destination);
        show(destination);
    }, 400); // Faster redirect
}

function handleEmailSignIn() {
    const email = document.getElementById('email-input').value;
    const password = document.getElementById('password-input').value;
    const statusEl = document.getElementById('signin-status');

    if (!email || !password) {
        statusEl.style.color = 'var(--danger)';
        statusEl.textContent = 'Please enter both email and password.';
        return;
    }
    const name = email.split('@')[0]; // Use part of email as name
    handleSignIn('Email', name);
}


function handleSignOut(e) {
    if (e) e.preventDefault();
    authState.isSignedIn = false;
    authState.user = null;
    authState.intendedRoute = null;
    saveAuthState();
    updateNavForAuth();
    history.pushState(null, '', '#home'); // Go to home page after sign out
    show('home');
}


// =============================================
// =========== PAGE ROUTING LOGIC ==============
// =============================================
if('scrollRestoration' in history) history.scrollRestoration='manual';
const pages=['home','species-wildlife','environment','disasters', 'time-mirror', 'chat', 'signin'];
let busy=false; 
async function show(id){
    if (id === 'chat' && !authState.isSignedIn) {
        authState.intendedRoute = 'chat';
        saveAuthState();
        history.pushState(null, '', '#signin');
        show('signin'); // Redirect to signin page
        return;
    }
    if(busy)return; 
    const cur=document.querySelector('.page.active'), next=document.getElementById(id); 
    if(!next||cur===next){setActiveLink(id);return;} 
    busy=true; 
    setActiveLink(id); 
    window.scrollTo(0,0); 
    if(cur){
        cur.classList.add('fading-out'); 
        await new Promise(r=>setTimeout(r,100)); 
        cur.classList.remove('fading-out','active'); 
        cur.style.display='none';
    } 
    next.style.display='block'; 
    next.getBoundingClientRect(); // Force reflow
    next.classList.add('active'); 
    await new Promise(r=>setTimeout(r,150)); 
    busy=false; 

    // --- ROBUST MAP INITIALIZATION AND RESIZING ---
    const mapInitializers = {
        'disasters': initializeDisasterMap,
        'environment': connectEnvMapSearch,
        'time-mirror': initializeTimeMirror,
        'species-wildlife': () => {
            if (window.maps['habitat'] && typeof window.maps['habitat'].invalidateSize === 'function') {
                setTimeout(() => window.maps['habitat'].invalidateSize(), 1);
            }
        }
    };
    
    // Call the initializer for the current page if it exists.
    // The functions themselves should prevent re-initialization.
    if (mapInitializers[id]) {
        mapInitializers[id]();
    }
}
function setActiveLink(id){
    document.querySelectorAll('nav a, .fab-menu-item a').forEach(a => a.classList.remove('active'));
    const link = document.getElementById('link-'+id);
    const fabLink = document.getElementById('fab-link-'+id);
    if (link) link.classList.add('active');
    if (fabLink) fabLink.classList.add('active');
}
document.addEventListener('click',(e)=>{
    const a=e.target.closest('a[href^="#"]'); 
    if(!a)return; 
    const id=a.getAttribute('href').slice(1); 
    if(!pages.includes(id))return; 
    e.preventDefault();
    
    if (id === 'signin' && authState.isSignedIn) return; 
    
    history.pushState(null,'','#'+id); 
    show(id);
});

window.addEventListener('popstate',()=>{
    const id=(location.hash||'#home').slice(1); 
    if(!pages.includes(id))return; 
    show(id);
});

window.addEventListener('DOMContentLoaded',()=>{
    loadAuthState();
    updateNavForAuth();
    
    let id=(location.hash||'#home').slice(1); 

    if (id === 'chat' && !authState.isSignedIn) {
        id = 'signin';
        authState.intendedRoute = 'chat';
        history.replaceState(null, '', '#signin');
    }

    if(!pages.includes(id)) {
        id = 'home';
        history.replaceState(null,'','#home'); 
    }
    
    pages.forEach(p=>{
        const el=document.getElementById(p); 
        if(!el)return; 
        if(p===id){el.classList.add('active'); el.style.display='block';} 
        else {el.classList.remove('active'); el.style.display='none';} 
        el.scrollTop=0;
    }); 
    window.scrollTo(0,0); 
    setActiveLink(id);
    
    // Initial map load if starting on a map page.
    if (['disasters', 'environment', 'time-mirror'].includes(id)) {
        show(id);
    }
    
    // Wire up sign-in buttons
    document.getElementById('email-signin-btn')?.addEventListener('click', handleEmailSignIn);
    document.getElementById('google-signin-btn')?.addEventListener('click', () => handleSignIn('Google', 'Google User'));
    document.getElementById('github-signin-btn')?.addEventListener('click', () => handleSignIn('GitHub', 'GitHub User'));

    // --- FAB Menu ---
    const fabContainer = document.querySelector('.fab-container');
    const fabToggle = document.getElementById('fab-toggle');

    if (fabToggle) {
        fabToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            fabContainer.classList.toggle('active');
        });

        document.querySelector('.fab-menu').addEventListener('click', (e) => {
             if (e.target.closest('a')) {
                fabContainer.classList.remove('active');
            }
        });
        
        document.addEventListener('click', (e) => {
            if (!fabContainer.contains(e.target) && fabContainer.classList.contains('active')) {
                fabContainer.classList.remove('active');
            }
        });
    }
});
</script>

<script>
// --- THEME TOGGLE SCRIPT ---
(function() {
    const themeToggle = document.getElementById('theme-toggle');
    if (!themeToggle) return;

    const updateIcon = () => {
        const currentTheme = document.body.getAttribute('data-theme');
        themeToggle.innerHTML = currentTheme === 'light' ? 'ðŸŒ™' : 'â˜€ï¸';
    };

    updateIcon();

    themeToggle.addEventListener('click', () => {
        let newTheme = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        document.body.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        updateIcon();
        updateAllChartThemes();
    });

    window.updateAllChartThemes = () => {
        const isLightTheme = document.body.getAttribute('data-theme') === 'light';
        const gridColor = isLightTheme ? 'rgba(0,0,0,0.1)' : 'rgba(154,163,173,0.15)';
        const textColor = isLightTheme ? '#606770' : '#9aa3ad';
        const titleColor = isLightTheme ? '#1d2129' : '#e8ecf1';

        for (const chartId in chartInstances) {
            const chart = chartInstances[chartId];
            if (chart) {
                chart.options.scales.x.grid.color = gridColor;
                chart.options.scales.y.grid.color = gridColor;
                chart.options.scales.x.ticks.color = textColor;
                chart.options.scales.y.ticks.color = textColor;
                chart.options.scales.x.title.color = textColor;
                chart.options.scales.y.title.color = textColor;
                chart.options.plugins.legend.labels.color = titleColor;
                chart.update();
            }
        }
    };
})();

// --- NEW ECOSYSTEM CHAT SCRIPT ---
document.addEventListener('DOMContentLoaded', () => {
    const chatContainer = document.getElementById('chat-container');
    const chatWindow = document.getElementById('chat-window');
    const chatInput = document.getElementById('chat-input');
    const sendBtn = document.getElementById('send-chat-btn');
    const typingIndicator = document.getElementById('typing-indicator');
    const ecosystemSelector = document.getElementById('ecosystem-selector');
    const chatPrompts = document.getElementById('chat-prompts');

    const ecosystemData = {
        rainforest: {
            name: "Amazon Rainforest",
            avatar: 'ðŸŒ³',
            backgroundImage: "url('https://images.unsplash.com/photo-1547634233-f73a3838232c?q=80&w=2070')",
            data: { moisture: -12, temp_anomaly: 2.1, biodiversity: 'Stressed' },
            prompts: ["How is the canopy?", "Are the rivers healthy?", "What is your greatest threat?"],
            personality: {
                greeting: "I feel the deep hum of life, but a fever is rising... My canopy thins, and the air is drier than it should be. [MOISTURE] [TEMP]",
                health_report: "My humidity has dropped significantly, which you can see in the data [MOISTURE]. The air feels warmer than usual, about [TEMP] above the baseline. My biodiversity is [BIODIVERSITY].",
                threat_report: "The greatest pains are the constant cuts of deforestation, the poison of illegal mining, and the growing heat that brings fire.",
                species_report: "I worry for many, like the Golden Lion Tamarin, whose habitat is shrinking. My overall biodiversity is [BIODIVERSITY]."
            }
        },
        tundra: {
            name: "Arctic Tundra",
            avatar: 'â„ï¸',
            backgroundImage: "url('https://images.unsplash.com/photo-1531310156540-62e910537248?q=80&w=1974')",
            data: { ice_melt: -8, temp_anomaly: 3.2, biodiversity: 'Shifting' },
            prompts: ["What is the permafrost status?", "How much ice has melted?", "Are new species arriving?"],
            personality: {
                greeting: "The ancient ice that holds me together is weeping. I feel... unstable. [ICE_MELT] [TEMP]",
                health_report: "My ground, once solid, is softening due to permafrost thaw. The temperature is [TEMP] too high, causing the ice to melt [ICE_MELT]. My biodiversity is [BIODIVERSITY].",
                threat_report: "My biggest fear is the permafrost thaw, which releases ancient carbon. The nearby sea ice loss [ICE_MELT] also affects the entire system, from the polar bears to the plankton.",
                species_report: "My children are confused. Southern species are moving in, and natives like the Arctic Fox are struggling to adapt as my state is [BIODIVERSITY]."
            }
        },
        reef: {
            name: "Great Barrier Reef",
            avatar: 'ðŸ ',
            backgroundImage: "url('https://images.unsplash.com/photo-1551202818-63643a415a70?q=80&w=1974')",
            data: { bleaching: 45, temp_anomaly: 1.7, biodiversity: 'Fading' },
            prompts: ["How severe is the coral bleaching?", "Is the water getting warmer?", "What creatures are suffering?"],
            personality: {
                greeting: "My colors are fading. The warmth of the water feels like a persistent, draining fever. [TEMP] [BLEACHING]",
                health_report: "The water is [TEMP] too warm, which is causing my coral to turn white. My vibrant color, my life force, is draining away. The bleaching is at [BLEACHING]% and my biodiversity is [BIODIVERSITY].",
                threat_report: "The relentless ocean warming is the primary cause of the bleaching. The slow poison of acidification and pollution from coastal runoff make it harder for me to recover.",
                species_report: "Countless creatures depend on me. When I bleach [BLEACHING], creatures like the Clownfish become homeless. It's a chain reaction of loss, my biodiversity is [BIODIVERSITY]."
            }
        },
        desert: {
            name: "Sahara Desert",
            avatar: 'ðŸœï¸',
            backgroundImage: "url('https://images.unsplash.com/photo-1473580044384-7ba9967e16a0?q=80&w=2070')",
            data: { expansion: 2, temp_anomaly: 2.8, biodiversity: 'Resilient' },
            prompts: ["Are you expanding?", "How hot is it?", "How do your species survive?"],
            personality: {
                greeting: "I am a land of sun and silence. The heat is my nature, but even I feel the sun's gaze intensify. [TEMP] I continue to grow. [EXPANSION]",
                health_report: "My nature is arid. However, the temperature is now [TEMP] higher than my historical average. My biodiversity remains surprisingly [BIODIVERSITY].",
                threat_report: "The heat waves are becoming more extreme. My biggest challenge is desertification [EXPANSION], as I expand into semi-arid regions, and the increasing water scarcity for the oases.",
                species_report: "Life here is tough but ingenious. Creatures like the Fennec Fox, with its large ears, are masters of survival. They are a testament to my [BIODIVERSITY] spirit."
            }
        }
    };

    const scrollToBottom = () => {
        if (chatWindow) chatWindow.scrollTop = chatWindow.scrollHeight;
    };

    const processDataNuggets = (text, data) => {
        return text.replace(/\[([^\]]+)\]/g, (match, key) => {
            let value, label, nuggetClass = '';
            switch (key.toUpperCase()) {
                case 'TEMP':
                    value = `+${data.temp_anomaly}Â°C`;
                    label = 'Temp';
                    nuggetClass = 'bad';
                    break;
                case 'MOISTURE':
                    value = `${data.moisture}%`;
                    label = 'Moisture';
                    nuggetClass = 'bad';
                    break;
                case 'BIODIVERSITY':
                    value = data.biodiversity;
                    label = 'Biodiversity';
                    if (value === 'Resilient' || value === 'Stable') nuggetClass = 'good';
                    else if (value === 'Shifting') nuggetClass = '';
                    else nuggetClass = 'bad';
                    break;
                case 'ICE_MELT':
                    value = `${data.ice_melt}%`;
                    label = 'Ice Melt';
                    nuggetClass = 'bad';
                    break;
                case 'BLEACHING':
                    value = `${data.bleaching}%`;
                    label = 'Bleaching';
                    nuggetClass = 'bad';
                    break;
                case 'EXPANSION':
                    value = `+${data.expansion}%`;
                    label = 'Expansion';
                    nuggetClass = '';
                    break;
                default:
                    return match;
            }
            return `<span class="data-nugget ${nuggetClass}">${label}: ${value}</span>`;
        });
    };
    
    const addMessage = (message, sender, avatar = '') => {
        if (!chatWindow) return;
        const messageDiv = document.createElement('div');
        messageDiv.className = `chat-message ${sender}-message`;
        
        if (sender === 'bot') {
            messageDiv.innerHTML = `<div class="bot-avatar">${avatar}</div><div>${message}</div>`;
        } else {
            messageDiv.innerHTML = `<div>${message}</div>`;
        }
        
        chatWindow.appendChild(messageDiv);
        scrollToBottom();
    };

    const getBotResponse = (userInput) => {
        const selectedKey = ecosystemSelector.value;
        if (!selectedKey) return;

        const ecosystem = ecosystemData[selectedKey];
        const lowerInput = userInput.toLowerCase();

        typingIndicator.classList.add('visible');
        scrollToBottom();

        let responseText = "";
        
        if (lowerInput.includes("how are you") || lowerInput.includes("health") || lowerInput.includes("status")) {
            responseText = ecosystem.personality.health_report;
        } else if (lowerInput.includes("threat") || lowerInput.includes("danger") || lowerInput.includes("hurting")) {
            responseText = ecosystem.personality.threat_report;
        } else if (lowerInput.includes("animal") || lowerInput.includes("species") || lowerInput.includes("wildlife")) {
            responseText = ecosystem.personality.species_report;
        } else if (lowerInput.includes("hello") || lowerInput.includes("hi")) {
            responseText = ecosystem.personality.greeting;
        } else {
            responseText = `I hear your words, but I can only speak of my health, my threats, and the species I shelter. Ask me about those.`;
        }

        const formattedResponse = processDataNuggets(responseText, ecosystem.data);

        setTimeout(() => {
            typingIndicator.classList.remove('visible');
            addMessage(formattedResponse, 'bot', ecosystem.avatar);
        }, 800 + Math.random() * 500);
    };

    const handleSend = () => {
        if (!chatInput) return;
        const userInput = chatInput.value.trim();
        if (userInput) {
            addMessage(userInput, 'user');
            chatInput.value = '';
            getBotResponse(userInput);
        }
    };
    
    const resetChat = () => {
        chatWindow.innerHTML = '';
        chatPrompts.innerHTML = '';
        const selectedKey = ecosystemSelector.value;

        if (selectedKey) {
            const ecosystem = ecosystemData[selectedKey];
            chatContainer.style.backgroundImage = ecosystem.backgroundImage;
            
            chatInput.disabled = false;
            sendBtn.disabled = false;
            chatInput.placeholder = `Ask the ${ecosystem.name}...`;
            
            const initialMessage = processDataNuggets(ecosystem.personality.greeting, ecosystem.data);
            addMessage(initialMessage, 'bot', ecosystem.avatar);

            ecosystem.prompts.forEach(promptText => {
                const btn = document.createElement('button');
                btn.className = 'chat-prompt-btn';
                btn.textContent = promptText;
                btn.onclick = () => {
                    chatInput.value = promptText;
                    handleSend();
                };
                chatPrompts.appendChild(btn);
            });

        } else {
            chatContainer.style.backgroundImage = 'none';
            chatInput.disabled = true;
            sendBtn.disabled = true;
            chatInput.placeholder = 'Select an ecosystem to begin';
            addMessage("Select an ecosystem above to begin a conversation.", 'bot', 'ðŸŒŽ');
        }
    };

    ecosystemSelector?.addEventListener('change', resetChat);
    sendBtn?.addEventListener('click', handleSend);
    chatInput?.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') handleSend();
    });

    // Initial state
    resetChat();
});

async function fetchJSON(u,o={}){try{const r=await fetch(u,o);if(!r.ok)return null;return await r.json();}catch(_){return null;}}
function buildGeocodeURL(source,q){return source==='builtin'?`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(q)}&format=json&limit=8&addressdetails=1`:`/api/geocode?q=${encodeURIComponent(q)}`}
function buildWeatherURL(source,lat,lon,tz){return source==='builtin'?`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,wind_speed_10m,relative_humidity_2m&hourly=temperature_2m${tz?`&timezone=${encodeURIComponent(tz)}`:''}`:`/api/weather/current?lat=${lat}&lon=${lon}`}
function normalizeGeocode(provider,data){if(provider==='builtin'){if(!data) return null; const r=Array.isArray(data)?data[0]:data; if(!r) return null; const addr=r.address||{}; return {name:r.display_name||r.name||'',admin1:(addr.state||addr.county||''),country:(addr.country||''),latitude:parseFloat(r.lat||0),longitude:parseFloat(r.lon||0),timezone:'auto'};} if(provider==='global'){if(!data) return null; return {name:data.name,admin1:data.admin1||'',country:data.country||'',latitude:data.latitude,longitude:data.longitude,timezone:data.timezone||'auto'};} return null;}
function normalizeWeather(v,d){if(v==='builtin'){const c=d.current||{}; return {tempC:c.temperature_2m,windMS:c.wind_speed_10m,rh:c.relative_humidity_2m,time:c.time};} if(v==='external'){return {tempC:d.temperature_c,windMS:d.wind_ms,rh:d.humidity,time:d.time};} return {};}
let indiaIndex=[]; async function loadIndiaIndexOnce(){if(indiaIndex.length) return indiaIndex; try{const r=await fetch('/data/india-cities.min.json',{headers:{accept:'application/json'}}); if(r.ok){indiaIndex=await r.json();}}catch(_){ } return indiaIndex;}
function indiaLocalMatches(q){const s=q.toLowerCase(); const hits=(indiaIndex||[]).filter(r=>{const c=(r.city||'').toLowerCase(), st=(r.state||'').toLowerCase(); return c.startsWith(s)||st.startsWith(s)||(`${r.city}, ${r.state}`.toLowerCase().startsWith(s));}).slice(0,8); return hits.map(r=>({label:`${r.city}${r.state?', '+r.state:''}, ${r.country||'India'}`,data:r}));}
(function(){const input=document.getElementById('placeQuery'),menu=document.getElementById('placeMenu'),geoSel=document.getElementById('geoSource'); let t=null,lastQ=''; async function suggest(){const q=input?.value.trim()||''; if(q.length<2){menu.classList.remove('open'); menu.innerHTML=''; return;} if(q===lastQ)return; lastQ=q; clearTimeout(t); t=setTimeout(async()=>{let items=[]; await loadIndiaIndexOnce(); items=items.concat(indiaLocalMatches(q).map(x=>({label:x.label,type:'india',data:x.data}))); try{const gUrl=buildGeocodeURL((geoSel?.value||'builtin'),q); const gr=await fetch(gUrl,{headers:{accept:'application/json'}}); if(gr.ok){const gd=await gr.json();            if((geoSel?.value||'builtin')==='builtin'){const arr=Array.isArray(gd)?gd:[]; items=items.concat(arr.slice(0,8).map(r=>{const addr=r.address||{}; return {label:r.display_name||'Unknown',type:'builtin',data:r};}));} else {const arr=Array.isArray(gd)?gd:[gd]; items=items.concat(arr.slice(0,8).map(r=>({label:`${r.name}${r.admin1?', '+r.admin1:''}${r.country?', '+r.country:''}`,type:'global',data:r})));}}}catch(_){ } if(!items.length){menu.classList.remove('open'); menu.innerHTML=''; return;} menu.innerHTML=items.map((it,i)=>`<button data-i="${i}" data-type="${it.type}">${it.label}</button>`).join(''); menu.classList.add('open'); menu._items=items;},100);} if(input&&menu){input.addEventListener('input',suggest); menu.addEventListener('click',e=>{const b=e.target.closest('button'); if(!b)return; const i=+b.getAttribute('data-i'); const it=(menu._items||[])[i]; if(!it)return; input.value=it.label; menu.classList.remove('open'); menu.innerHTML=''; input.dispatchEvent(new Event('change'));}); document.addEventListener('click',e=>{if(!menu.contains(e.target)&&e.target!==input){menu.classList.remove('open');}}); }})();
const locBtn=document.getElementById('searchPlace'); if(locBtn){locBtn.addEventListener('click', async ()=>{const q=document.getElementById('placeQuery').value.trim(); const out=document.getElementById('placeResult'); const srcSel=document.getElementById('locSource'); const geoSel=document.getElementById('geoSource'); const weatherSource=srcSel?srcSel.value:'builtin'; const geoSource=geoSel?geoSel.value:'builtin'; if(!q){out.textContent='Enter a place name.'; return;} out.textContent='Searchingâ€¦'; let G=null; try{const gUrl=buildGeocodeURL(geoSource,q); const gres=await fetch(gUrl,{headers:{accept:'application/json'}});        if(gres.ok){const gdata=await gres.json(); if(geoSource==='builtin'){const arr=Array.isArray(gdata)?gdata:[]; G=arr.length?normalizeGeocode('builtin',arr[0]):null;} else {const arr=Array.isArray(gdata)?gdata:[gdata]; const pick=arr[0]||null; G=pick?normalizeGeocode('global',pick):null;}}}catch(_){ } if(!G){await loadIndiaIndexOnce(); const local=(indiaIndex||[]).find(r=>(r.city&&q.toLowerCase().startsWith(r.city.toLowerCase()))); if(local){G={name:local.city||local.state,admin1:local.state||'',country:local.country||'India',latitude:local.lat,longitude:local.lon,timezone:'Asia/Kolkata'};}} if(!G){out.textContent='No matches found. Add state/country or switch Geocoder to Global (Proxy).'; return;} try{const {name,admin1,country,latitude,longitude,timezone}=G; const wUrl=buildWeatherURL(weatherSource,latitude,longitude,timezone); const wres=await fetch(wUrl,{headers:{accept:'application/json'}}); if(!wres.ok) throw new Error('Forecast failed'); const wdata=await wres.json(); const W=normalizeWeather(weatherSource==='builtin'?'builtin':'external',wdata); let preview=''; if(weatherSource==='builtin' && wdata.hourly?.time && wdata.hourly?.temperature_2m){preview=wdata.hourly.time.slice(0,6).map((t,i)=>`${t.substring(11,16)}: ${wdata.hourly.temperature_2m[i]}Â°C`).join(' | ');} out.textContent=`Place: ${name}${admin1?', '+admin1:''}, ${country}\nLat/Lon: ${latitude}, ${longitude}\nTimezone: ${timezone||'auto'}\nCurrent: ${W.time||'n/a'}\nTemp: ${W.tempC??'n/a'} Â°C, Wind ${W.windMS??'n/a'} m/s, RH ${W.rh??'n/a'} %\n${preview?'Next hours: '+preview:''}`; const latEl=document.getElementById('lat'); const lonEl=document.getElementById('lon'); if(latEl&&lonEl){latEl.value=latitude; lonEl.value=longitude;} }catch(_){out.textContent='Resolved location, but weather failed to load.';} });}

(function(){
    const input=document.getElementById('placeQueryHome'),menu=document.getElementById('placeMenuHome'),geoSel=document.getElementById('geoSourceHome');
    let t=null,lastQ='';
    async function suggest(){
        const q=input?.value.trim()||'';
        if(q.length<2){menu.classList.remove('open'); menu.innerHTML=''; return;}
        if(q===lastQ)return;
        lastQ=q;
        clearTimeout(t);
        t=setTimeout(async()=>{
            let items=[];
            await loadIndiaIndexOnce();
            items=items.concat(indiaLocalMatches(q).map(x=>({label:x.label,type:'india',data:x.data})));
            try{
                const gUrl=buildGeocodeURL((geoSel?.value||'builtin'),q);
                const gr=await fetch(gUrl,{headers:{accept:'application/json'}});
                if(gr.ok){
                    const gd=await gr.json();
                    if((geoSel?.value||'builtin')==='builtin'){const arr=Array.isArray(gd)?gd:[]; items=items.concat(arr.slice(0,8).map(r=>({label:r.display_name||'Unknown',type:'builtin',data:r})));}
                    else {const arr=Array.isArray(gd)?gd:[gd]; items=items.concat(arr.slice(0,8).map(r=>({label:`${r.name}${r.admin1?', '+r.admin1:''}${r.country?', '+r.country:''}`,type:'global',data:r})));}
                }
            }catch(_){ }
            if(!items.length){menu.classList.remove('open'); menu.innerHTML=''; return;}
            menu.innerHTML=items.map((it,i)=>`<button data-i="${i}" data-type="${it.type}">${it.label}</button>`).join('');
            menu.classList.add('open');
            menu._items=items;
        },100);
    }
    if(input&&menu){
        input.addEventListener('input',suggest);
        menu.addEventListener('click',e=>{
            const b=e.target.closest('button'); if(!b)return;
            const i=+b.getAttribute('data-i');
            const it=(menu._items||[])[i]; if(!it)return;
            input.value=it.label;
            menu.classList.remove('open'); menu.innerHTML='';
            input.dispatchEvent(new Event('change'));
        });
        document.addEventListener('click',e=>{if(!menu.contains(e.target)&&e.target!==input){menu.classList.remove('open');}});
    }
})();

const locBtnHome=document.getElementById('searchPlaceHome');
if(locBtnHome){
    locBtnHome.addEventListener('click', async ()=>{
        const q=document.getElementById('placeQueryHome').value.trim();
        const statusOut=document.getElementById('placeStatusHome');
        const currentCard=document.getElementById('currentWeatherHome');
        const forecastCard=document.getElementById('forecastWeatherHome');
        const currentContent=document.getElementById('currentWeatherContent');
        const forecastContent=document.getElementById('forecastContent');
        const geoSel=document.getElementById('geoSourceHome');
        const geoSource=geoSel?geoSel.value:'builtin';

        if(!q){
            statusOut.textContent='Enter a place name.';
            currentCard.style.display='none';
            forecastCard.style.display='none';
            return;
        }
        statusOut.textContent='Searching locationâ€¦';
        currentCard.style.display='none';
        forecastCard.style.display='none';

        let G=null;
        try{
            const gUrl=buildGeocodeURL(geoSource,q);
            const gres=await fetch(gUrl,{headers:{accept:'application/json'}});
            if(gres.ok){
                const gdata=await gres.json();
                if(geoSource==='builtin'){const arr=Array.isArray(gdata)?gdata:[]; G=arr.length?normalizeGeocode('builtin',arr[0]):null;}
                else {const arr=Array.isArray(gdata)?gdata:[gdata]; const pick=arr[0]||null; G=pick?normalizeGeocode('global',pick):null;}
            }
        }catch(_){ }

        if(!G){
            await loadIndiaIndexOnce();
            const local=(indiaIndex||[]).find(r=>(r.city&&q.toLowerCase().startsWith(r.city.toLowerCase())));
            if(local){G={name:local.city||local.state,admin1:local.state||'',country:local.country||'India',latitude:local.lat,longitude:local.lon,timezone:'Asia/Kolkata'};}
        }

        if(!G){
            statusOut.textContent='No matches found. Try adding state/country or switch Geocoder to Global (Proxy).';
            return;
        }

        statusOut.textContent='Loading weather dataâ€¦';
        
        try{
            const {name,admin1,country,latitude,longitude,timezone}=G;

            // Update the Windy map iframe
            const mapIframe = document.querySelector('#global-weather-map iframe');
            if (mapIframe) {
              const newSrc = `https://embed.windy.com/embed2.html?lat=${latitude}&lon=${longitude}&zoom=10&level=surface&overlay=wind&menu=&message=true&marker=&calendar=&pressure=true&type=map&location=coordinates&detail=&metricWind=km/h&metricTemp=%C2%B0C`;
              mapIframe.src = newSrc;
            }

            const wUrl=`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,rain,showers,snowfall,weather_code,cloud_cover,pressure_msl,surface_pressure,wind_speed_10m,wind_direction_10m,wind_gusts_10m&daily=weather_code,temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,sunrise,sunset,precipitation_sum,rain_sum,showers_sum,snowfall_sum,precipitation_hours,precipitation_probability_max,wind_speed_10m_max,wind_gusts_10m_max,wind_direction_10m_dominant&timezone=${encodeURIComponent(timezone||'auto')}`;
            const wres=await fetch(wUrl,{headers:{accept:'application/json'}});
            if(!wres.ok) throw new Error('Weather fetch failed');
            const data=await wres.json();
            const current=data.current||{};
            const daily=data.daily||{};

            statusOut.textContent=`Showing weather for: ${name}${admin1?', '+admin1:''}, ${country} (${latitude.toFixed(4)}, ${longitude.toFixed(4)})`;

            currentCard.style.display='block';
            currentContent.innerHTML=`<div style="padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145"><div style="font-size:13px;color:#9aa3ad;margin-bottom:4px">Temperature</div><div style="font-size:24px;font-weight:600;color:#66e3c4">${current.temperature_2m??'â€”'}Â°C</div><div style="font-size:12px;color:#9aa3ad;margin-top:4px">Feels like ${current.apparent_temperature??'â€”'}Â°C</div></div><div style="padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145"><div style="font-size:13px;color:#9aa3ad;margin-bottom:4px">Humidity</div><div style="font-size:24px;font-weight:600;color:#7aa7ff">${current.relative_humidity_2m??'â€”'}%</div></div><div style="padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145"><div style="font-size:13px;color:#9aa3ad;margin-bottom:4px">Wind Speed</div><div style="font-size:24px;font-weight:600;color:#ff9966">${current.wind_speed_10m??'â€”'} m/s</div><div style="font-size:12px;color:#9aa3ad;margin-top:4px">Gusts ${current.wind_gusts_10m??'â€”'} m/s</div></div><div style="padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145"><div style="font-size:13px;color:#9aa3ad;margin-bottom:4px">Precipitation</div><div style="font-size:24px;font-weight:600;color:#5bb3ff">${current.precipitation??'â€”'} mm</div></div><div style="padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145"><div style="font-size:13px;color:#9aa3ad;margin-bottom:4px">Cloud Cover</div><div style="font-size:24px;font-weight:600;color:#b8c5d6">${current.cloud_cover??'â€”'}%</div></div><div style="padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145"><div style="font-size:13px;color:#9aa3ad;margin-bottom:4px">Pressure</div><div style="font-size:24px;font-weight:600;color:#ffcc66">${current.pressure_msl??'â€”'} hPa</div></div>`;

            forecastCard.style.display='block';
            const days=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
            forecastContent.innerHTML=(daily.time||[]).slice(0,7).map((d,i)=>{
                const date=new Date(d);
                const dayName=days[date.getDay()];
                const tempMax=daily.temperature_2m_max?.[i]??'â€”';
                const tempMin=daily.temperature_2m_min?.[i]??'â€”';
                const precip=daily.precipitation_sum?.[i]??'0';
                const windMax=daily.wind_speed_10m_max?.[i]??'â€”';
                const precipProb=daily.precipitation_probability_max?.[i]??'0';
                return `<div style="padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145;text-align:center"><div style="font-size:14px;font-weight:600;color:#e8ecf1;margin-bottom:8px">${dayName}</div><div style="font-size:11px;color:#9aa3ad;margin-bottom:8px">${d}</div><div style="font-size:20px;font-weight:600;color:#66e3c4;margin-bottom:4px">${tempMax}Â°</div><div style="font-size:13px;color:#7aa7ff;margin-bottom:8px">${tempMin}Â°</div><div style="font-size:11px;color:#9aa3ad;margin-bottom:2px">ðŸ’§ ${precip} mm (${precipProb}%)</div><div style="font-size:11px;color:#9aa3ad">ðŸ’¨ ${windMax} m/s</div></div>`;
            }).join('');

            const latEl=document.getElementById('lat');
            const lonEl=document.getElementById('lon');
            if(latEl&&lonEl){latEl.value=latitude; lonEl.value=longitude;}

        }catch(err){
            statusOut.textContent='Weather data could not be loaded. Please try again.';
            currentCard.style.display='none';
            forecastCard.style.display='none';
        }
    });
}


const loadBtn=document.getElementById('loadWeather'); if(loadBtn){loadBtn.addEventListener('click', async ()=>{const out=document.getElementById('weather'); const lat=(document.getElementById('lat').value||'').trim(); const lon=(document.getElementById('lon').value||'').trim(); const source=document.getElementById('climSource')?.value||'builtin'; out.textContent='Loadingâ€¦'; try{const url=buildWeatherURL(source,encodeURIComponent(lat),encodeURIComponent(lon)); const res=await fetch(url,{headers:{accept:'application/json'}}); if(!res.ok) throw new Error('Weather fetch failed'); const data=await res.json(); const n=normalizeWeather(source==='builtin'?'builtin':'external',data); out.textContent=`Time: ${n.time||'n/a'}\nTemp: ${n.tempC??'n/a'} Â°C\nWind: ${n.windMS??'n/a'} m/s\nRH: ${n.rh??'n/a'} %`; }catch(_){out.textContent='Could not load weather.';} });}

async function gbifSuggest(q){const url=`https://api.gbif.org/v1/species/suggest?q=${encodeURIComponent(q)}&limit=10`; const res=await fetch(url,{headers:{accept:'application/json'}}); if(!res.ok) return []; const arr=await res.json(); return arr.map(r=>{const sci=r.canonicalName||r.scientificName||r.species||r.genus||r.family||r.name||q; const com=r.vernacularName||''; return {key:r.key,canonicalName:sci,vernacularName:com,label:com?`${sci} â€” ${com}`:sci};});}
function wireSuggest(inputId,menuId,onPick){const input=document.getElementById(inputId),menu=document.getElementById(menuId); if(!input||!menu) return; let t=null; input.addEventListener('input',()=>{const q=input.value.trim(); clearTimeout(t); if(q.length<2){menu.classList.remove('open'); menu.innerHTML=''; return;} t=setTimeout(async()=>{const items=await gbifSuggest(q); if(!items.length){menu.classList.remove('open'); menu.innerHTML=''; return;} menu.innerHTML=items.map(it=>`<button data-key="${it.key}" data-sci="${it.canonicalName}" data-com="${it.vernacularName||''}">${it.label}</button>`).join(''); menu.classList.add('open');},100);}); menu.addEventListener('click',(e)=>{const btn=e.target.closest('button'); if(!btn) return; const sci=btn.getAttribute('data-sci'); const key=btn.getAttribute('data-key'); input.value=sci; menu.classList.remove('open'); menu.innerHTML=''; onPick&&onPick({scientificName:sci,key});}); document.addEventListener('click',(e)=>{if(!menu.contains(e.target)&&e.target!==input){menu.classList.remove('open');}});}

// =========================================================
// ============= UNIFIED WILDLIFE PAGE LOGIC ===============
// =========================================================

async function performSpeciesLookup(query) {
    const out = document.getElementById('speciesResult');
    if (!query) {
        out.innerHTML = `<div class="result-placeholder"><div>ðŸ§¬</div>Enter a species name in the unified search bar.</div>`;
        return;
    }
    out.innerHTML = `<div class="result-placeholder"><div>â³</div>Resolving name: "${query}"...</div>`;

    const exactURL = `https://api.gbif.org/v1/species/match?name=${encodeURIComponent(query)}&strict=true`;
    let match = await fetchJSON(exactURL, { headers: { accept: 'application/json' } });

    if (!match || !match.usageKey || match.matchType === 'NONE') {
        const s = await fetchJSON(`https://api.gbif.org/v1/species/search?q=${encodeURIComponent(query)}&limit=1`);
        match = s?.results?.[0];
    }
    
    const key = match?.key || match?.usageKey;
    const sci = match?.canonicalName || match?.scientificName || query;

    if (!key) {
        out.innerHTML = `<div class="result-placeholder"><div>âŒ</div>No species found for "${query}".</div>`;
        return;
    }

    out.innerHTML = `<div class="result-placeholder"><div>â³</div>Fetching data for ${sci}...</div>`;
    const base = `https://api.gbif.org/v1/species/${key}`;
    const [meta, ver] = await Promise.all([ fetchJSON(base), fetchJSON(`${base}/vernacularNames`) ]);
    const wikiSummaryPromise = fetchJSON(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(sci.replace(/\s+/g, '_'))}`);
    
    const taxonomy = ['kingdom', 'phylum', 'class', 'order', 'family', 'genus']
        .map(rank => meta?.[rank] || '')
        .filter(Boolean)
        .join(' â†’ ');

    const vernaculars = ver?.results?.slice(0, 8).map(v => `<li>${v.vernacularName} ${v.language ? `[${v.language}]` : ''}</li>`).join('') || '<li>Not available</li>';
    
    const wiki = await wikiSummaryPromise;
    const summary = wiki?.extract ? `${wiki.extract} <a href="${wiki.content_urls?.desktop?.page}" target="_blank" rel="noopener">Source: Wikipedia</a>` : 'No Wikipedia summary available.';

    out.innerHTML = `
        <div class="species-header">
            <h4>${sci}</h4>
            <div class="rank">${meta?.rank || 'N/A'}</div>
        </div>
        <div class="card-content">
            <p class="species-summary">${summary}</p>
            <div class="grid" style="gap: 18px;">
                <div class="span-7 info-box">
                    <h5>Taxonomy</h5>
                    <p>${taxonomy}</p>
                </div>
                <div class="span-5 info-box">
                    <h5>Common Names</h5>
                    <ul class="tag-list">${vernaculars}</ul>
                </div>
            </div>
        </div>
    `;
}

async function performClimateSurvivalCheck(animalName) {
    const out = document.getElementById('animalResult');
    if (!animalName) {
        out.innerHTML = `<div class="result-placeholder"><div>ðŸŒ¡ï¸</div>Run a unified search for an evaluation.</div>`;
        return;
    }
    
    const name = animalName.toLowerCase();
    let tol = aliasIndex[name];
    if (!tol) {
        out.innerHTML = `<div class="card climate-survival-card" style="border-left-color: var(--muted);"><div style="padding: 16px;"><h5>Status Unknown</h5><p class="muted">No tolerance profile found for "${animalName}". You can add one in the editor.</p></div></div>`;
        return;
    }
    
    out.innerHTML = `<div class="result-placeholder"><div>â³</div>Loading local weather...</div>`;
    
    const lat = '28.6139', lon = '77.2090', source = 'builtin'; // Default location

    try {
        const url = buildWeatherURL(source, encodeURIComponent(lat), encodeURIComponent(lon));
        const res = await fetch(url, {headers: {accept: 'application/json'}});
        if (!res.ok) throw new Error('Weather fetch failed');
        
        const data = await res.json();
        const n = normalizeWeather(source === 'builtin' ? 'builtin' : 'external', data);
        const temp = Number(n.tempC), rh = Number(n.rh), wind = Number(n.windMS);
        
        const [tMin, tMax] = tol.tempC, [hMin, hMax] = tol.rh, [wMin, wMax] = tol.windMS;
        const dT = temp < tMin ? (temp - tMin) : (temp > tMax ? (temp - tMax) : 0);
        const dH = rh < hMin ? (rh - hMin) : (rh > hMax ? (rh - hMax) : 0);
        const dW = wind < wMin ? (wind - wMin) : (wind > wMax ? (wind - wMax) : 0);
        
        const score = Math.abs(dT) * 2 + Math.abs(dH) * 0.5 + Math.abs(dW) * 0.8;
        let outlook, color;
        if (score > 35) { outlook = 'Critical'; color = 'var(--danger)'; }
        else if (score > 20) { outlook = 'High Stress'; color = '#ff9966'; }
        else if (score > 10) { outlook = 'Caution'; color = '#ffcc66'; }
        else { outlook = 'Stable'; color = 'var(--accent)'; }
        
        out.innerHTML = `
            <div class="card climate-survival-card" style="border-left-color: ${color};">
                <div style="padding: 16px;">
                    <h5>Status: ${outlook}</h5>
                    <div class="climate-stats-grid">
                        <div>
                            <h6>Temperature</h6>
                            <div class="stat-value">${isFinite(temp) ? temp.toFixed(1) : 'â€“'}<span class="muted">Â°C</span></div>
                            <div class="stat-delta ${dT === 0 ? 'delta-good' : 'delta-bad'}">${dT.toFixed(1)}Â°C</div>
                        </div>
                        <div>
                            <h6>Humidity</h6>
                            <div class="stat-value">${isFinite(rh) ? rh.toFixed(0) : 'â€“'}<span class="muted">%</span></div>
                            <div class="stat-delta ${dH === 0 ? 'delta-good' : 'delta-bad'}">${dH.toFixed(1)}%</div>
                        </div>
                         <div>
                            <h6>Wind</h6>
                            <div class="stat-value">${isFinite(wind) ? wind.toFixed(1) : 'â€“'}<span class="muted">m/s</span></div>
                            <div class="stat-delta ${dW === 0 ? 'delta-good' : 'delta-bad'}">${dW.toFixed(1)}m/s</div>
                        </div>
                    </div>
                </div>
            </div>`;
    } catch (_) {
        out.innerHTML = `<div class="card climate-survival-card" style="border-left-color: var(--danger);"><div style="padding: 16px;"><h5>Error</h5><p class="muted">Could not retrieve weather for evaluation.</p></div></div>`;
    }
}

// =========================================================
// ========= ADVANCED SPECIES EXTINCTION SIMULATOR =========
// =========================================================

const speciesExtinctionProfiles = {
    'panthera tigris': { // Bengal Tiger
        base_survivability: 75,
        resilience: 0.6, // Less resilient to change
        threats: { 'Habitat Loss': 1.5, 'Poaching': 1.2, 'Human-Wildlife Conflict': 0.8 }
    },
    'panthera uncia': { // Snow Leopard
        base_survivability: 80,
        resilience: 0.7,
        threats: { 'Climate Change': 1.8, 'Habitat Loss': 0.8, 'Poaching': 0.6 }
    },
    'vulpes lagopus': { // Arctic Fox
        base_survivability: 95,
        resilience: 0.8,
        threats: { 'Climate Change': 1.6, 'Competition from Red Foxes': 1.1 }
    },
    'default': {
        base_survivability: 95,
        resilience: 1.0, // Assumed average resilience
        threats: { 'General Environmental Stress': 1.0 }
    }
};

function runExtinctionSimulation(speciesName) {
    const placeholder = document.getElementById('extinctionPlaceholder');
    const resultsContainer = document.getElementById('extinctionResultContainer');
    const timelineResult = document.getElementById('extinctionTimelineResult');

    if (!speciesName) {
        placeholder.innerHTML = '<div class="result-placeholder"><div>ðŸ“‰</div>Run a unified search to generate a what-if survival timeline.</div>';
        resultsContainer.style.display = 'none';
        placeholder.style.display = 'block';
        return;
    }

    placeholder.innerHTML = `<div class="result-placeholder"><div>â³</div>Simulating 20-year timeline for ${speciesName}...</div>`;
    resultsContainer.style.display = 'none';
    placeholder.style.display = 'block';

    setTimeout(() => {
        const profileKey = speciesName.toLowerCase();
        const profile = speciesExtinctionProfiles[profileKey] || speciesExtinctionProfiles['default'];
        
        const currentYear = new Date().getFullYear();
        const years = Array.from({ length: 21 }, (_, i) => currentYear + i);
        
        let survivability = profile.base_survivability;
        const data = [survivability];

        for (let i = 1; i < years.length; i++) {
            let stressFactor = 0.5 + Math.random() * 1.5; // Base environmental stress
            
            // Add stress from specific threats
            for (const threat in profile.threats) {
                stressFactor += (Math.random() * 0.5 + 0.5) * profile.threats[threat];
            }
            
            // Apply resilience modifier (lower resilience = higher impact)
            const resilienceImpact = (2.0 - profile.resilience);
            const yearlyDecline = stressFactor * resilienceImpact;

            survivability -= yearlyDecline;
            data.push(Math.max(0, survivability));
        }

        const finalSurvivability = data[data.length - 1];
        let outlookMessage, outlookColor;
        if (finalSurvivability < 20) {
            outlookMessage = `<strong>CRITICAL OUTLOOK:</strong> The simulation projects a severe decline, with the survivability index dropping below 20%. This species faces a high risk of localized extinction without immediate, large-scale intervention.`;
            outlookColor = 'var(--danger)';
        } else if (finalSurvivability < 50) {
            outlookMessage = `<strong>NEGATIVE OUTLOOK:</strong> The model shows a significant downward trend. Key threats are causing substantial population stress, indicating a need for targeted conservation efforts to prevent further decline.`;
            outlookColor = '#ff9966';
        } else {
            outlookMessage = `<strong>STABLE OUTLOOK:</strong> While facing pressures, the species shows resilience in this simulation. Continued monitoring and proactive conservation are recommended to maintain this stability.`;
            outlookColor = 'var(--accent)';
        }

        timelineResult.innerHTML = `
            <div class="grid" style="gap: 12px; margin-bottom: 16px;">
                <div class="span-12 info-box">
                    <h5>Primary Threat Factors Simulated</h5>
                    <ul class="tag-list">
                        ${Object.keys(profile.threats).map(t => `<li>${t}</li>`).join('')}
                    </ul>
                     ${profileKey === 'default' ? '<p class="muted" style="margin-top:10px; font-size:12px;">Note: A generalized stress model was used as no specific profile was found for this species.</p>' : ''}
                </div>
            </div>
            <div class="extinction-summary" style="border-left-color: ${outlookColor};">
                ${outlookMessage}
            </div>`;
        
        createExtinctionChart(speciesName, years, data);
        placeholder.style.display = 'none';
        resultsContainer.style.display = 'block';
        if (window.updateAllChartThemes) window.updateAllChartThemes();
    }, 500); // Slightly longer timeout for effect
}


// 4. Function for DNA Habitat Analysis
function runDnaAnalysis(speciesName) {
    const placeholder = document.getElementById('dnaPlaceholder');
    const resultContainer = document.getElementById('dnaResultContainer');
    
    if (!speciesName) {
        placeholder.innerHTML = '<div class="result-placeholder"><div>ðŸ—ºï¸</div>Run a unified search to visualize suitable habitat.</div>';
        resultContainer.style.display = 'none';
        placeholder.style.display = 'block';
        return;
    }
    
    placeholder.innerHTML = `<div class="result-placeholder"><div>â³</div>Analyzing genomic markers for "${speciesName}"...</div>`;
    placeholder.style.display = 'block';
    resultContainer.style.display = 'none';
    
    setTimeout(() => {
        lastAnalyzedProfile = analyzeGenomicProfile(speciesName);
        const seed = speciesName.split('').reduce((a, b) => ((a << 5) - a + b.charCodeAt(0)) | 0, 0);
        lastSeededRandom = () => { const x = Math.sin(seed + lastAnalyzedProfile.scores.cryo) * 10000; return x - Math.floor(x); };

        if (!window.maps['habitat']) {
             const map = L.map('habitatMap').setView([20, 0], 2);
             L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', { attribution: 'Â© OpenStreetMap contributors Â© CARTO' }).addTo(map);
             window.maps['habitat'] = map;
        }
        
        drawHabitatZones(lastAnalyzedProfile, false, lastSeededRandom);
        updateDnaText(speciesName, lastAnalyzedProfile, false);

        placeholder.style.display = 'none';
        resultContainer.style.display = 'block';
        setTimeout(() => { if(window.maps['habitat']) window.maps['habitat'].invalidateSize() }, 100);

        document.getElementById('dnaViewCurrent').classList.add('primary');
        document.getElementById('dnaViewFuture').classList.remove('primary');

    }, 120); 
}


// 5. Master Search Function
async function runUnifiedWildlifeSearch() {
    const query = document.getElementById('unifiedSpeciesQuery').value.trim();
    if (!query) {
        alert('Please enter a species name to search.');
        return;
    }
    
    // Trigger map initialization if not already done
    if (!window.maps['habitat']) {
        const map = L.map('habitatMap').setView([20, 0], 2);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', { attribution: 'Â© OpenStreetMap contributors Â© CARTO' }).addTo(map);
        window.maps['habitat'] = map;
    }

    document.getElementById('speciesResult').innerHTML = `<div class="result-placeholder"><div>â³</div>Searching for "${query}"...</div>`;
    document.getElementById('animalResult').innerHTML = `<div class="result-placeholder"><div>â³</div>Evaluating "${query}"...</div>`;
    document.getElementById('extinctionPlaceholder').innerHTML = `<div class="result-placeholder"><div>â³</div>Simulating for "${query}"...</div>`;
    document.getElementById('extinctionResultContainer').style.display = 'none';
    document.getElementById('extinctionPlaceholder').style.display = 'block';
    document.getElementById('dnaPlaceholder').innerHTML = `<div class="result-placeholder"><div>â³</div>Analyzing "${query}"...</div>`;
    document.getElementById('dnaResultContainer').style.display = 'none';
    document.getElementById('dnaPlaceholder').style.display = 'block';

    performSpeciesLookup(query);
    performClimateSurvivalCheck(query);
    runExtinctionSimulation(query);
    runDnaAnalysis(query);
}

// 6. Wire up the new unified search bar and button
document.addEventListener('DOMContentLoaded', () => {
    wireSuggest('unifiedSpeciesQuery', 'unifiedSpeciesMenu', (picked) => {
        document.getElementById('unifiedSpeciesQuery').value = picked.scientificName || picked.label;
        runUnifiedWildlifeSearch();
    });
    document.getElementById('unifiedSearchBtn')?.addEventListener('click', runUnifiedWildlifeSearch);
    document.getElementById('unifiedSpeciesQuery')?.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') runUnifiedWildlifeSearch();
    });
});


function displayAlerts(alerts,source='Unknown'){const container=document.getElementById('alertsContainer'); const status=document.getElementById('capStatus'); if(!alerts||alerts.length===0){status.style.display='block'; container.innerHTML=''; return;} status.style.display='none'; const severityColors={'Extreme':'#ff6b6b','Severe':'#ff9966','Moderate':'#ffcc66','Minor':'#66e3c4','Unknown':'#9aa3ad'}; const severityIcons={'Extreme':'ðŸ”´','Severe':'ðŸŸ ','Moderate':'ðŸŸ¡','Minor':'ðŸŸ¢','Unknown':'âšª'}; container.innerHTML=`<div style="margin-bottom:16px;padding:12px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:10px;border:1px solid #2a3145"><div style="display:flex;align-items:center;gap:8px"><div style="font-size:20px">ðŸ“¡</div><div><div style="font-size:14px;font-weight:600;color:#e8ecf1">Source: ${source}</div><div style="font-size:12px;color:#9aa3ad">Showing ${alerts.length} active alert${alerts.length===1?'':'s'}</div></div></div></div>`+alerts.map((alert,i)=>{const sev=alert.severity||'Unknown'; const color=severityColors[sev]||'#9aa3ad'; const icon=severityIcons[sev]||'âšª'; return `<div style="margin-bottom:12px;padding:16px;background:linear-gradient(135deg,#1a2332,#0f1523);border-radius:12px;border-left:4px solid ${color};box-shadow:0 4px 12px rgba(0,0,0,0.2)"><div style="display:flex;align-items:start;gap:12px;margin-bottom:12px"><div style="font-size:24px">${icon}</div><div style="flex:1"><div style="display:flex;align-items:center;gap:8px;margin-bottom:8px"><span style="display:inline-block;padding:4px 10px;border-radius:999px;background:rgba(${sev==='Extreme'?'255,107,107':sev==='Severe'?'255,153,102':sev==='Moderate'?'255,204,102':'102,227,196'},0.15);color:${color};font-size:11px;font-weight:600;text-transform:uppercase">${sev}</span>${alert.certainty?`<span style="display:inline-block;padding:4px 10px;border-radius:999px;background:rgba(154,163,173,0.15);color:#9aa3ad;font-size:11px">${alert.certainty}</span>`:''}</div><h3 style="margin:0 0 8px;font-size:18px;color:#e8ecf1;line-height:1.3">${alert.headline||alert.event||`Alert ${i+1}`}</h3>${alert.area?`<div style="display:flex;align-items:center;gap:6px;margin-bottom:6px;font-size:13px;color:#9aa3ad"><span>ðŸ“</span><span>${alert.area}</span></div>`:''}</div></div>${alert.description?`<div style="padding:12px;background:#0a0e16;border-radius:8px;margin-bottom:12px"><div style="font-size:13px;color:#b8c5d6;line-height:1.6">${alert.description.substring(0,300)}${alert.description.length>300?'...':''}</div></div>`:''}${alert.instruction?`<div style="padding:12px;background:rgba(102,227,196,0.08);border:1px solid rgba(102,227,196,0.2);border-radius:8px;margin-bottom:8px"><div style="font-size:12px;font-weight:600;color:#66e3c4;margin-bottom:4px">âš¡ INSTRUCTIONS</div><div style="font-size:13px;color:#d6e8e3;line-height:1.5">${alert.instruction}</div></div>`:''}${alert.onset||alert.expires?`<div style="display:flex;gap:16px;flex-wrap:wrap;font-size:12px;color:#9aa3ad">${alert.onset?`<div><span style="color:#7aa7ff">ðŸ• Onset:</span> ${new Date(alert.onset).toLocaleString()}</div>`:''}${alert.expires?`<div><span style="color:#ff9966">â° Expires:</span> ${new Date(alert.expires).toLocaleString()}</div>`:''}</div>`:''}</div>`;}).join('');}
function distance(lat1,lon1,lat2,lon2){const R=6371;const dLat=(lat2-lat1)*Math.PI/180;const dLon=(lon2-lon1)*Math.PI/180;const a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return R*c;}
async function loadLocationAlerts(lat,lon,radius,locationName){const container=document.getElementById('alertsContainer');const status=document.getElementById('capStatus');status.style.display='none';container.innerHTML='<div style="text-align:center;padding:40px;color:#9aa3ad"><div style="font-size:32px;margin-bottom:12px">â³</div><div>Searching for alerts near '+locationName+'...</div></div>';try{const usgsUrl=`https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/significant_week.geojson`;const res=await fetch(usgsUrl);if(!res.ok)throw new Error('Failed to fetch earthquake data (Status: '+res.status+')');const data=await res.json();const features=data.features||[];if(features.length===0){container.innerHTML='<div style="text-align:center;padding:40px;color:#9aa3ad"><div style="font-size:32px;margin-bottom:12px">âœ…</div><div>No significant earthquakes in the past week</div></div>';return;}const nearbyAlerts=features.map((feature,i)=>{const props=feature.properties||{};const coords=feature.geometry?.coordinates||[];const alertLon=coords[0];const alertLat=coords[1];const magnitude=props.mag||0;const place=props.place||'Unknown location';const title=props.title||`Magnitude ${magnitude} earthquake`;const url=props.url||'';const time=props.time?new Date(props.time).toISOString():'';let severity='Moderate';if(magnitude>=7.0)severity='Extreme';else if(magnitude>=6.0)severity='Severe';else if(magnitude>=5.0)severity='Moderate';else severity='Minor';let isNearby=false;if(!isNaN(alertLat)&&!isNaN(alertLon)){const d=distance(lat,lon,alertLat,alertLon);if(d<=radius){isNearby=true;}}if(!isNearby){const searchText=(title+' '+place).toLowerCase();const searchParts=locationName.toLowerCase().split(',').map(p=>p.trim()).filter(Boolean);for(const part of searchParts){if(part.length>2&&searchText.includes(part)){isNearby=true;break;}}}return{headline:title,area:place,severity:severity,certainty:'Observed',description:`Magnitude ${magnitude} earthquake detected. Depth: ${coords[2]||'Unknown'} km. ${props.tsunami===1?'âš ï¸ TSUNAMI WARNING ISSUED':'No tsunami warning.'}`,instruction:`Monitor local authorities for updates. ${url?'More info: '+url:''}`,onset:time,expires:'',event:'Earthquake',isNearby:isNearby};}).filter(a=>a.isNearby).slice(0,15);if(nearbyAlerts.length===0){container.innerHTML='<div style="text-align:center;padding:40px;color:#9aa3ad"><div style="font-size:32px;margin-bottom:12px">âœ…</div><div>No significant earthquakes found within '+radius+' km of '+locationName+'</div><div style="margin-top:12px;font-size:13px">Checked '+features.length+' earthquakes from USGS</div></div>';return;}displayAlerts(nearbyAlerts,'Significant Earthquakes within '+radius+' km of '+locationName);}catch(err){container.innerHTML=`<div style="text-align:center;padding:40px;color:#ff6b6b"><div style="font-size:32px;margin-bottom:12px">âŒ</div><div>Failed to load earthquake alerts</div><div style="margin-top:8px;font-size:13px;color:#ff9966">${err.message}</div><div style="margin-top:8px;font-size:12px;color:#9aa3ad">Try the "Load All Global Alerts" button instead</div></div>`;}}
(function(){const input=document.getElementById('disasterLocationQuery'),menu=document.getElementById('disasterLocationMenu');let t=null,lastQ='';async function suggest(){const q=input?.value.trim()||'';if(q.length<2){menu.classList.remove('open');menu.innerHTML='';return;}if(q===lastQ)return;lastQ=q;clearTimeout(t);t=setTimeout(async()=>{let items=[];try{const gUrl=`https://photon.komoot.io/api/?q=${encodeURIComponent(q)}&limit=8`;const gr=await fetch(gUrl,{headers:{accept:'application/json'}});if(gr.ok){const gd=await gr.json();const features=(gd.features||[]).slice(0,8);items=items.concat(features.map(f=>{const props=f.properties||{};const coords=f.geometry?.coordinates||[];const name=props.name||props.city||props.state||'Unknown';const city=props.city||'';const state=props.state||'';const country=props.country||'';const parts=[name];if(city&&city!==name)parts.push(city);if(state&&state!==name)parts.push(state);if(country)parts.push(country);return{label:parts.filter(Boolean).join(', '),type:'photon',data:{...props,lat:coords[1],lon:coords[0]}};}));}}catch(_){}if(!items.length){menu.classList.remove('open');menu.innerHTML='';return;}menu.innerHTML=items.map((it,i)=>`<button data-i="${i}" data-type="${it.type}">${it.label}</button>`).join('');menu.classList.add('open');menu._items=items;},180);}if(input&&menu){input.addEventListener('input',suggest);menu.addEventListener('click',e=>{const b=e.target.closest('button');if(!b)return;const i=+b.getAttribute('data-i');const it=(menu._items||[])[i];if(!it)return;input.value=it.label;menu.classList.remove('open');menu.innerHTML='';input.dispatchEvent(new Event('change'));});document.addEventListener('click',e=>{if(!menu.contains(e.target)&&e.target!==input){menu.classList.remove('open');}});}})();
const searchDisasterBtn=document.getElementById('searchDisasterLocation');if(searchDisasterBtn){searchDisasterBtn.addEventListener('click',async()=>{const q=document.getElementById('disasterLocationQuery').value.trim();const radius=parseInt(document.getElementById('alertRadius').value)||250;if(!q){alert('Please enter a location');return;}const statusDiv=document.getElementById('locationDisasterStatus');const predDiv=document.getElementById('disasterPredictions');const wildlifeDiv=document.getElementById('wildlifeImpactAssessment');const container=document.getElementById('alertsContainer');const capStatus=document.getElementById('capStatus');statusDiv.style.display='block';predDiv.style.display='none';wildlifeDiv.style.display='none';statusDiv.innerHTML='<div style="text-align:center;padding:40px;color:#9aa3ad"><div style="font-size:32px;margin-bottom:12px">ðŸ”</div><div>Analyzing disaster status for '+q+'...</div></div>';container.innerHTML='';capStatus.style.display='none';try{const gUrl=`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(q)}&format=json&limit=1&addressdetails=1`;const gres=await fetch(gUrl,{headers:{'Accept':'application/json'}});if(!gres.ok)throw new Error('Geocoding failed');const gdata=await gres.json();if(!Array.isArray(gdata)||gdata.length===0){statusDiv.innerHTML='<div class="card" style="border-left:4px solid #ff9966"><div style="text-align:center;padding:20px"><div style="font-size:32px;margin-bottom:12px">ðŸ“</div><div>Location not found. Please try a different search term.</div></div></div>';return;}const result=gdata[0];const lat=parseFloat(result.lat);const lon=parseFloat(result.lon);const name=result.display_name||q;const[weatherRes,earthquakes]=await Promise.all([fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,precipitation,wind_speed_10m&daily=temperature_2m_max,precipitation_sum,wind_speed_10m_max&timezone=auto`),fetch('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson')]);let status='Safe';let riskLevel='Low';let risks=[];let nearbyDisasters=[];if(weatherRes.ok){const weather=await weatherRes.json();const curr=weather.current||{};const daily=weather.daily||{};if(curr.temperature_2m>40)risks.push({type:'Extreme Heat',severity:'High',detail:`${curr.temperature_2m}Â°C - Heat stress risk`});if(curr.precipitation>50)risks.push({type:'Heavy Rain',severity:'High',detail:`${curr.precipitation}mm/h - Flood risk`});if(curr.wind_speed_10m>25)risks.push({type:'High Winds',severity:'Severe',detail:`${curr.wind_speed_10m} m/s - Structural damage risk`});const nextDayPrecip=daily.precipitation_sum?.[1]||0;if(nextDayPrecip>100)risks.push({type:'Flash Flood',severity:'High',detail:`${nextDayPrecip}mm forecast tomorrow`});}if(earthquakes.ok){const eqData=await earthquakes.json();const features=eqData.features||[];nearbyDisasters=features.filter(f=>{const coords=f.geometry?.coordinates||[];const eqLat=coords[1];const eqLon=coords[0];const d=distance(lat,lon,eqLat,eqLon);return d<=radius;}).slice(0,5).map(f=>{const props=f.properties||{};const coords=f.geometry?.coordinates||[];return{type:'Earthquake',magnitude:props.mag||0,location:props.place||'',distance:distance(lat,lon,coords[1],coords[0]).toFixed(0),time:props.time?new Date(props.time).toLocaleString():''};});}if(risks.length>0||nearbyDisasters.length>0){if(risks.some(r=>r.severity==='Severe'))status='High Risk';else if(risks.length>=2||nearbyDisasters.length>0)status='Moderate Risk';else status='Low Risk';riskLevel=status==='High Risk'?'High':status==='Moderate Risk'?'Moderate':'Low';}const statusColor=status==='High Risk'?'#ff6b6b':status==='Moderate Risk'?'#ffcc66':'#66e3c4';statusDiv.innerHTML=`<div class="card" style="border-left:4px solid ${statusColor}"><h3 style="margin:0 0 8px">ðŸ“Š Disaster Status: ${name}</h3><div style="display:inline-block;padding:8px 16px;border-radius:999px;background:rgba(${status==='High Risk'?'255,107,107':status==='Moderate Risk'?'255,204,102':'102,227,196'},0.2);color:${statusColor};font-size:14px;font-weight:600;margin-bottom:16px">${status.toUpperCase()}</div><div style="font-size:13px;color:#9aa3ad;margin-bottom:16px">Last updated: ${new Date().toLocaleString()}</div>${risks.length>0?`<div style="padding:12px;background:#0a0e16;border-radius:8px;margin-bottom:12px"><h4 style="margin:0 0 8px;font-size:14px;color:#ff9966">âš ï¸ Active Risk Factors</h4>${risks.map(r=>`<div style="padding:8px;background:rgba(255,107,107,0.08);border-radius:6px;margin-bottom:6px"><div style="font-size:13px;font-weight:600;color:#ff6b6b">${r.type} (${r.severity})</div><div style="font-size:12px;color:#ff9966">${r.detail}</div></div>`).join('')}</div>`:''} ${nearbyDisasters.length>0?`<div style="padding:12px;background:#0a0e16;border-radius:8px;margin-bottom:12px"><h4 style="margin:0 0 8px;font-size:14px;color:#ff6b6b">ðŸŒ‹ Recent Nearby Disasters (within ${radius}km)</h4>${nearbyDisasters.map(d=>`<div style="padding:8px;background:rgba(255,107,107,0.08);border-radius:6px;margin-bottom:6px"><div style="font-size:13px;font-weight:600;color:#ff6b6b">M${d.magnitude} Earthquake - ${d.distance}km away</div><div style="font-size:12px;color:#ff9966">${d.location} - ${d.time}</div></div>`).join('')}</div>`:''} ${risks.length===0&&nearbyDisasters.length===0?`<div style="padding:16px;background:rgba(102,227,196,0.08);border-radius:8px;text-align:center"><div style="font-size:32px;margin-bottom:8px">âœ…</div><div style="font-size:14px;color:#66e3c4;font-weight:600">No Active Threats</div><div style="font-size:13px;color:#9aa3ad;margin-top:4px">This location is currently safe with no immediate disaster risks detected.</div></div>`:''}</div>`;wildlifeDiv.style.display='block';wildlifeDiv.innerHTML=`<div class="card" style="border-left:4px solid #66e3c4"><h3 style="margin:0 0 12px">ðŸ¦ Wildlife Impact Assessment</h3><div style="padding:12px;background:#0a0e16;border-radius:8px;margin-bottom:8px"><h4 style="margin:0 0 8px;font-size:14px;color:#66e3c4">Habitat Status</h4><div style="font-size:13px;color:#9aa3ad;line-height:1.6">${risks.length>0||nearbyDisasters.length>0?'Wildlife in this region may experience stress from current conditions. Key concerns include habitat disruption, food source availability, and migration pattern changes.':'Current conditions are stable for wildlife. Normal habitat conditions with no immediate threats to local fauna.'}</div></div>${risks.length>0||nearbyDisasters.length>0?`<div style="padding:12px;background:rgba(255,107,107,0.08);border:1px solid rgba(255,107,107,0.2);border-radius:8px;margin-bottom:8px"><div style="font-size:12px;font-weight:600;color:#ff6b6b;margin-bottom:6px">âš ï¸ WILDLIFE RISK FACTORS</div><ul style="margin:4px 0;padding-left:20px;font-size:13px;color:#ff9966;line-height:1.8">${risks.map(r=>`<li>${r.type}: Potential for animal displacement and stress</li>`).join('')}${nearbyDisasters.length>0?'<li>Seismic activity: Marine and terrestrial species behavioral changes</li>':''}</ul></div>`:''}<div style="padding:12px;background:#0a0e16;border-radius:8px"><h4 style="margin:0 0 8px;font-size:14px;color:#7aa7ff">ðŸ“Š Ecosystem Health Indicators</h4><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:8px">${[{label:'Habitat Integrity',value:risks.length===0?'95%':'72%',color:risks.length===0?'#66e3c4':'#ffcc66'},{label:'Food Availability',value:risks.length===0?'Normal':'Reduced',color:risks.length===0?'#66e3c4':'#ff9966'},{label:'Migration Status',value:nearbyDisasters.length>0?'Disrupted':'Normal',color:nearbyDisasters.length>0?'#ff6b6b':'#66e3c4'}].map(i=>`<div style="padding:8px;background:rgba(122,167,255,0.08);border-radius:6px;text-align:center"><div style="font-size:11px;color:#9aa3ad;margin-bottom:4px">${i.label}</div><div style="font-size:16px;font-weight:600;color:${i.color}">${i.value}</div></div>`).join('')}</div></div></div>`;await loadLocationAlerts(lat,lon,radius,name);}catch(err){statusDiv.innerHTML=`<div class="card" style="border-left:4px solid #ff6b6b"><div style="text-align:center;padding:20px"><div style="font-size:32px;margin-bottom:12px">âŒ</div><div>Failed to analyze location</div><div style="margin-top:8px;font-size:13px;color:#ff9966">${err.message}</div></div></div>`;}});}
const loadAllGlobalBtn=document.getElementById('loadAllGlobalDisasters'); if(loadAllGlobalBtn){loadAllGlobalBtn.addEventListener('click',loadAllGlobalDisasters);}
const loadPredictionsBtn=document.getElementById('loadDisasterPredictions'); if(loadPredictionsBtn){loadPredictionsBtn.addEventListener('click',showDisasterPredictions);}
async function loadAllGlobalDisasters(){const container=document.getElementById('alertsContainer');const status=document.getElementById('capStatus');status.style.display='none';container.innerHTML='<div style="text-align:center;padding:40px;color:#9aa3ad"><div style="font-size:32px;margin-bottom:12px">â³</div><div>Loading global disasters from multiple sources...</div></div>';try{const[earthquakes,gdacs]=await Promise.all([fetch('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson'),fetch('https://www.gdacs.org/xml/rss.xml')]);let allDisasters=[];if(earthquakes.ok){const eqData=await earthquakes.json();const features=eqData.features||[];allDisasters=allDisasters.concat(features.slice(0,20).map(f=>{const props=f.properties||{};const coords=f.geometry?.coordinates||[];const mag=props.mag||0;let severity='Minor';if(mag>=7.0)severity='Extreme';else if(mag>=6.0)severity='Severe';else if(mag>=5.0)severity='Moderate';return{headline:`M${mag} Earthquake - ${props.place||'Unknown'}`,area:`${props.place||'Unknown'} (${coords[1]?.toFixed(2)}, ${coords[0]?.toFixed(2)})`,severity:severity,certainty:'Observed',description:`Magnitude ${mag} earthquake at ${coords[2]?.toFixed(1)||'?'} km depth. ${props.tsunami===1?'âš ï¸ TSUNAMI WARNING':'No tsunami'}.`,instruction:`Monitor authorities. ${props.url||''}`,onset:props.time?new Date(props.time).toISOString():'',expires:'',event:'Earthquake',type:'earthquake',lat:coords[1],lon:coords[0]};}));}if(gdacs.ok){const text=await gdacs.text();const parser=new DOMParser();const xml=parser.parseFromString(text,'text/xml');const items=xml.getElementsByTagName('item');allDisasters=allDisasters.concat(Array.from(items).slice(0,15).map((item,i)=>{const getTag=(tag)=>item.getElementsByTagName(tag)[0]?.textContent||'';const title=getTag('title');const country=getTag('gdacs:country')||'Global';const eventType=getTag('gdacs:eventtype')||'Disaster';const alertLevel=getTag('gdacs:alertlevel');let severity='Moderate';if(alertLevel==='Red')severity='Extreme';else if(alertLevel==='Orange')severity='Severe';else if(alertLevel==='Green')severity='Minor';const coordsText=getTag('georss:point');const coords=coordsText.split(' ').map(parseFloat);return{headline:title||`${eventType} Alert`,area:country,severity:severity,certainty:'Observed',description:getTag('description')||'',instruction:'Follow local authorities',onset:getTag('gdacs:fromdate')||'',expires:getTag('gdacs:todate')||'',event:eventType,type:eventType.toLowerCase(),lat:coords[0]||null,lon:coords[1]||null};}));}allDisasters.sort((a,b)=>{const order={Extreme:0,Severe:1,Moderate:2,Minor:3};return (order[a.severity]||4)-(order[b.severity]||4);});displayAlerts(allDisasters,`All Global Disasters (${allDisasters.length} active events from USGS & GDACS)`);}catch(err){container.innerHTML=`<div style="text-align:center;padding:40px;color:#ff6b6b"><div style="font-size:32px;margin-bottom:12px">âŒ</div><div>Failed to load global disasters</div><div style="margin-top:8px;font-size:13px">${err.message}</div></div>`;}}
async function showDisasterPredictions(){const predDiv=document.getElementById('disasterPredictions');predDiv.style.display='block';predDiv.innerHTML='<div style="text-align:center;padding:40px;color:#9aa3ad"><div style="font-size:32px;margin-bottom:12px">â³</div><div>Analyzing global weather patterns for disaster predictions...</div></div>';setTimeout(()=>{const predictions=[{type:'Tropical Cyclone',location:'Bay of Bengal',risk:'High',probability:75,timeframe:'3-5 days',description:'Weather models indicate favorable conditions for cyclone formation with warm sea surface temperatures (29-31Â°C) and low wind shear.',impact:'Coastal flooding, wind damage, heavy rainfall',wildlife:'Displacement of coastal bird populations, stress on marine ecosystems'},{type:'Wildfire',location:'California, USA',risk:'Extreme',probability:85,timeframe:'1-3 days',description:'Severe drought conditions combined with high temperatures (38-42Â°C), low humidity (&lt;15%), and strong Santa Ana winds create critical fire danger.',impact:'Forest destruction, air quality hazards, property damage',wildlife:'Habitat loss for mountain lions, black bears, and endemic bird species. Smoke inhalation risks.'},{type:'Flood',location:'Southeast Asia (Mekong Delta)',risk:'Moderate',probability:60,timeframe:'5-7 days',description:'Monsoon rainfall forecast shows 200-300mm precipitation over next week. Rivers approaching flood stage.',impact:'Agricultural damage, displacement, infrastructure damage',wildlife:'Wetland bird sanctuaries at risk, fish migration disruption'},{type:'Earthquake',location:'Pacific Ring of Fire',risk:'Moderate',probability:45,timeframe:'Ongoing monitoring',description:'Increased seismic activity detected along subduction zones. Multiple M4+ events in past 48 hours indicate stress accumulation.',impact:'Structural damage, potential tsunamis in coastal areas',wildlife:'Marine mammal behavior changes, bird migration pattern disruptions'},{type:'Drought',location:'Horn of Africa',risk:'Severe',probability:90,timeframe:'Ongoing (next 30 days)',description:'Fourth consecutive failed rainy season. Soil moisture at historic lows. Temperature anomalies +2-4Â°C above average.',impact:'Food insecurity, water scarcity, livestock losses',wildlife:'Mass elephant migration, endangered antelope species at critical risk, predator-prey imbalances'}];const riskColors={Extreme:'#ff6b6b',Severe:'#ff9966',High:'#ffcc66',Moderate:'#7aa7ff'};predDiv.innerHTML=`<div class="card" style="border-left:4px solid #7aa7ff"><h3 style="margin:0 0 8px">ðŸ”® 7-Day Disaster Risk Predictions</h3><p style="margin:0 0 16px;font-size:14px;color:#9aa3ad">AI-powered analysis of weather patterns, seismic activity, and historical data</p></div>`+predictions.map(pred=>{const color=riskColors[pred.risk]||'#9aa3ad';return`<div class="card" style="border-left:4px solid ${color};margin-top:12px"><div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:12px"><div><h4 style="margin:0 0 4px;font-size:18px;color:#e8ecf1">${pred.type}</h4><div style="font-size:14px;color:#9aa3ad">ðŸ“ ${pred.location}</div></div><div style="text-align:right"><div style="display:inline-block;padding:6px 12px;border-radius:999px;background:rgba(${pred.risk==='Extreme'?'255,107,107':pred.risk==='Severe'?'255,153,102':pred.risk==='High'?'255,204,102':'122,167,255'},0.2);color:${color};font-size:12px;font-weight:600">${pred.risk} RISK</div><div style="font-size:13px;color:#9aa3ad;margin-top:4px">Probability: ${pred.probability}%</div></div></div><div style="padding:12px;background:#0a0e16;border-radius:8px;margin-bottom:12px"><div style="font-size:13px;color:#b8c5d6;margin-bottom:8px"><strong style="color:#7aa7ff">Timeframe:</strong> ${pred.timeframe}</div><div style="font-size:13px;color:#b8c5d6;line-height:1.6">${pred.description}</div></div><div style="padding:12px;background:rgba(255,107,107,0.08);border:1px solid rgba(255,107,107,0.2);border-radius:8px;margin-bottom:8px"><div style="font-size:12px;font-weight:600;color:#ff6b6b;margin-bottom:4px">âš ï¸ EXPECTED IMPACT</div><div style="font-size:13px;color:#ff9966">${pred.impact}</div></div><div style="padding:12px;background:rgba(102,227,196,0.08);border:1px solid rgba(102,227,196,0.2);border-radius:8px"><div style="font-size:12px;font-weight:600;color:#66e3c4;margin-bottom:4px">ðŸ¦ WILDLIFE IMPACT</div><div style="font-size:13px;color:#9dd6c7">${pred.wildlife}</div></div></div>`;}).join('');},1500);}

let chartInstances={};
function createTempAnomalyChart(){const ctx=document.getElementById('tempAnomalyChart');if(!ctx)return;if(chartInstances.tempAnomaly)chartInstances.tempAnomaly.destroy();const years=[1880,1890,1900,1910,1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2015,2020,2023,2024];const temps=[-0.18,-0.36,-0.13,-0.42,-0.26,-0.15,0.13,0.03,-0.02,0.03,0.26,0.45,0.62,0.90,1.13,1.25,1.48,1.55];chartInstances.tempAnomaly=new Chart(ctx,{type:'line',data:{labels:years,datasets:[{label:'Temperature Anomaly (Â°C)',data:temps,borderColor:'#ff6b6b',backgroundColor:'rgba(255,107,107,0.2)',borderWidth:3,fill:true,tension:0.4,pointRadius:5,pointHoverRadius:8,pointBackgroundColor:'#ff6b6b',pointBorderColor:'#fff',pointBorderWidth:2}]},options:{responsive:true,maintainAspectRatio:false,animation: { duration: 0 }, interaction:{mode:'index',intersect:false},plugins:{legend:{display:true,labels:{color:'#e8ecf1',font:{size:14,weight:'500'}}},tooltip:{backgroundColor:'#0f1523',titleColor:'#e8ecf1',bodyColor:'#9aa3ad',borderColor:'#2a3145',borderWidth:1,padding:12,displayColors:true,callbacks:{label:function(context){return 'Temperature: '+context.parsed.y.toFixed(2)+'Â°C';}}},zoom:{pan:{enabled:true,mode:'x'},zoom:{wheel:{enabled:true},pinch:{enabled:true},mode:'x',drag:{enabled:true,backgroundColor:'rgba(102,227,196,0.1)',borderColor:'#66e3c4',borderWidth:1}}}},scales:{y:{title:{display:true,text:'Temperature Anomaly (Â°C)',color:'#9aa3ad',font:{size:13,weight:'500'}},grid:{color:'rgba(154,163,173,0.15)',drawBorder:false},ticks:{color:'#9aa3ad',font:{size:12},padding:8}},x:{title:{display:true,text:'Year',color:'#9aa3ad',font:{size:13,weight:'500'}},grid:{color:'rgba(154,163,173,0.1)',drawBorder:false},ticks:{color:'#9aa3ad',font:{size:12},padding:8}}}}});}
function createCO2Chart(){const ctx=document.getElementById('co2Chart');if(!ctx)return;if(chartInstances.co2)chartInstances.co2.destroy();const years=[1960,1970,1980,1990,2000,2010,2015,2020,2022,2023,2024];const co2=[317,325,339,354,369,389,400,414,421,424,424];chartInstances.co2=new Chart(ctx,{type:'line',data:{labels:years,datasets:[{label:'COâ‚‚ Concentration (ppm)',data:co2,borderColor:'#7aa7ff',backgroundColor:'rgba(122,167,255,0.2)',borderWidth:3,fill:true,tension:0.4,pointRadius:5,pointHoverRadius:8,pointBackgroundColor:'#7aa7ff',pointBorderColor:'#fff',pointBorderWidth:2}]},options:{responsive:true,maintainAspectRatio:false,animation: { duration: 0 }, interaction:{mode:'index',intersect:false},plugins:{legend:{display:true,labels:{color:'#e8ecf1',font:{size:14,weight:'500'}}},tooltip:{backgroundColor:'#0f1523',titleColor:'#e8ecf1',bodyColor:'#9aa3ad',borderColor:'#2a3145',borderWidth:1,padding:12,displayColors:true,callbacks:{label:function(context){return 'COâ‚‚: '+context.parsed.y+' ppm';}}},zoom:{pan:{enabled:true,mode:'x'},zoom:{wheel:{enabled:true},pinch:{enabled:true},mode:'x',drag:{enabled:true,backgroundColor:'rgba(122,167,255,0.1)',borderColor:'#7aa7ff',borderWidth:1}}}},scales:{y:{title:{display:true,text:'COâ‚‚ (ppm)',color:'#9aa3ad',font:{size:13,weight:'500'}},grid:{color:'rgba(154,163,173,0.15)',drawBorder:false},ticks:{color:'#9aa3ad',font:{size:12},padding:8}},x:{title:{display:true,text:'Year',color:'#9aa3ad',font:{size:13,weight:'500'}},grid:{color:'rgba(154,163,173,0.1)',drawBorder:false},ticks:{color:'#9aa3ad',font:{size:12},padding:8}}}}});}
function resetChartZoom(chartName){if(chartInstances[chartName]){chartInstances[chartName].resetZoom();}}
function setChartRange(chartName,minYear,maxYear){const chart=chartInstances[chartName];if(!chart)return;chart.zoomScale('x',{min:minYear,max:maxYear},{mode:'zoom'});}
const projectionScenarios={ssp126:{name:'SSP1-2.6 (Low Emissions)',description:'Sustainable development pathway with rapid emissions reductions. Global warming limited to approximately <strong style="color:#66e3c4">+1.8Â°C by 2100</strong>. Achieves net-zero COâ‚‚ emissions around 2050.',color:'#66e3c4',data:[1.55,1.65,1.73,1.80]},ssp245:{name:'SSP2-4.5 (Medium Emissions)',description:'Intermediate pathway where emissions decline moderately. Global warming reaches approximately <strong style="color:#ffcc66">+2.7Â°C by 2100</strong>. This scenario assumes gradual implementation of climate policies and some renewable energy transition.',color:'#ffcc66',data:[1.55,1.85,2.20,2.70]},ssp370:{name:'SSP3-7.0 (High Emissions)',description:'Regional rivalry pathway with increasing emissions. Global warming reaches approximately <strong style="color:#ff9966">+3.6Â°C by 2100</strong>. Limited international cooperation on climate action.',color:'#ff9966',data:[1.55,2.05,2.85,3.60]},ssp585:{name:'SSP5-8.5 (Very High Emissions)',description:'Fossil-fueled development pathway with very high emissions. Global warming reaches approximately <strong style="color:#ff6b6b">+4.4Â°C by 2100</strong>. Represents a worst-case scenario with minimal climate action.',color:'#ff6b6b',data:[1.55,2.15,3.20,4.40]}};
function createProjectionChart(scenario='ssp245'){const ctx=document.getElementById('projectionChart');if(!ctx)return;if(chartInstances.projection)chartInstances.projection.destroy();const years=[2024,2040,2070,2100];const s=projectionScenarios[scenario];chartInstances.projection=new Chart(ctx,{type:'line',data:{labels:years,datasets:[{label:'Historical (2024)',data:[{x:2024,y:1.55}],borderColor:'#9aa3ad',backgroundColor:'rgba(154,163,173,0.5)',borderWidth:0,pointRadius:8,pointHoverRadius:10,pointStyle:'circle',showLine:false,pointBorderColor:'#fff',pointBorderWidth:2},{label:s.name,data:s.data,borderColor:s.color,backgroundColor:`${s.color}30`,borderWidth:3,fill:true,tension:0.4,pointRadius:6,pointHoverRadius:9,borderDash:[],pointBackgroundColor:s.color,pointBorderColor:'#fff',pointBorderWidth:2}]},options:{responsive:true,maintainAspectRatio:false,animation: { duration: 0 }, interaction:{mode:'index',intersect:false},plugins:{legend:{display:true,labels:{color:'#e8ecf1',font:{size:14,weight:'500'},padding:15}},tooltip:{backgroundColor:'#0f1523',titleColor:'#e8ecf1',bodyColor:'#9aa3ad',borderColor:'#2a3145',borderWidth:1,padding:12,displayColors:true,callbacks:{label:function(context){return context.dataset.label+': '+context.parsed.y.toFixed(2)+'Â°C';}}},zoom:{pan:{enabled:true,mode:'x'},zoom:{wheel:{enabled:true},pinch:{enabled:true},mode:'x',drag:{enabled:true,backgroundColor:`${s.color}20`,borderColor:s.color,borderWidth:1}}},annotation:{annotations:{line1:{type:'line',yMin:1.5,yMax:1.5,borderColor:'#ff6b6b',borderWidth:2,borderDash:[5,5],label:{display:true,content:'1.5Â°C Paris Limit',position:'end',backgroundColor:'rgba(255,107,107,0.9)',color:'#fff',font:{size:11,weight:'600'},padding:6}},line2:{type:'line',yMin:2.0,yMax:2.0,borderColor:'#ff9966',borderWidth:2,borderDash:[5,5],label:{display:true,content:'2.0Â°C Threshold',position:'end',backgroundColor:'rgba(255,153,102,0.9)',color:'#fff',font:{size:11,weight:'600'},padding:6}}}}},scales:{y:{title:{display:true,text:'Global Temperature Increase (Â°C)',color:'#9aa3ad',font:{size:13,weight:'500'}},grid:{color:'rgba(154,163,173,0.15)',drawBorder:false},ticks:{color:'#9aa3ad',font:{size:12},padding:8},min:1.0,max:5.0},x:{title:{display:true,text:'Year',color:'#9aa3ad',font:{size:13,weight:'500'}},grid:{color:'rgba(154,163,173,0.1)',drawBorder:false},ticks:{color:'#9aa3ad',font:{size:12},padding:8}}}}});}
function showAllProjections(){const ctx=document.getElementById('projectionChart');if(!ctx)return;if(chartInstances.projection)chartInstances.projection.destroy();const years=[2024,2040,2070,2100];const datasets=[{label:'Historical (2024)',data:[{x:2024,y:1.55}],borderColor:'#9aa3ad',backgroundColor:'rgba(154,163,173,0.5)',borderWidth:0,pointRadius:8,pointHoverRadius:10,pointStyle:'circle',showLine:false,pointBorderColor:'#fff',pointBorderWidth:2}];Object.keys(projectionScenarios).forEach(key=>{const s=projectionScenarios[key];datasets.push({label:s.name,data:s.data,borderColor:s.color,backgroundColor:'transparent',borderWidth:3,fill:false,tension:0.4,pointRadius:5,pointHoverRadius:8,pointBackgroundColor:s.color,pointBorderColor:'#fff',pointBorderWidth:2});});chartInstances.projection=new Chart(ctx,{type:'line',data:{labels:years,datasets:datasets},options:{responsive:true,maintainAspectRatio:false,animation: { duration: 0 }, interaction:{mode:'index',intersect:false},plugins:{legend:{display:true,labels:{color:'#e8ecf1',font:{size:13,weight:'500'},padding:12}},tooltip:{backgroundColor:'#0f1523',titleColor:'#e8ecf1',bodyColor:'#9aa3ad',borderColor:'#2a3145',borderWidth:1,padding:12,displayColors:true},zoom:{pan:{enabled:true,mode:'x'},zoom:{wheel:{enabled:true},pinch:{enabled:true},mode:'x',drag:{enabled:true,backgroundColor:'rgba(122,167,255,0.1)',borderColor:'#7aa7ff',borderWidth:1}}},annotation:{annotations:{line1:{type:'line',yMin:1.5,yMax:1.5,borderColor:'#ff6b6b',borderWidth:2,borderDash:[5,5],label:{display:true,content:'1.5Â°C Paris Limit',position:'end',backgroundColor:'rgba(255,107,107,0.9)',color:'#fff',font:{size:11,weight:'600'},padding:6}},line2:{type:'line',yMin:2.0,yMax:2.0,borderColor:'#ff9966',borderWidth:2,borderDash:[5,5],label:{display:true,content:'2.0Â°C Threshold',position:'end',backgroundColor:'rgba(255,153,102,0.9)',color:'#fff',font:{size:11,weight:'600'},padding:6}}}}},scales:{y:{title:{display:true,text:'Global Temperature Increase (Â°C)',color:'#9aa3ad',font:{size:13,weight:'500'}},grid:{color:'rgba(154,163,173,0.15)',drawBorder:false},ticks:{color:'#9aa3ad',font:{size:12},padding:8},min:1.0,max:5.0},x:{title:{display:true,text:'Year',color:'#9aa3ad',font:{size:13,weight:'500'}},grid:{color:'rgba(154,163,173,0.1)',drawBorder:false},ticks:{color:'#9aa3ad',font:{size:12},padding:8}}}}});const info=document.getElementById('projectionInfo');if(info){info.innerHTML=`<h4 style="margin:0 0 8px;font-size:16px;color:#e8ecf1">All Emission Scenarios Comparison</h4><p style="margin:0;font-size:14px;color:#9aa3ad;line-height:1.6">Comparing all four SSP scenarios shows the range of possible climate futures from <strong style="color:#66e3c4">+1.8Â°C (best case)</strong> to <strong style="color:#ff6b6b">+4.4Â°C (worst case)</strong> by 2100. The choice between these pathways depends on immediate climate action.</p>`;}}
function updateProjection(scenario){createProjectionChart(scenario);const info=document.getElementById('projectionInfo');const s=projectionScenarios[scenario];if(info&&s){info.innerHTML=`<h4 style="margin:0 0 8px;font-size:16px;color:#e8ecf1">${s.name}</h4><p style="margin:0;font-size:14px;color:#9aa3ad;line-height:1.6">${s.description}</p>`;}}
document.addEventListener('DOMContentLoaded',()=>{
    const trendsPage=document.getElementById('environment');
    if(trendsPage){
        setTimeout(()=>{
            if(document.getElementById('tempAnomalyChart')){
                createTempAnomalyChart();
                createCO2Chart();
                createProjectionChart();
                if (window.updateAllChartThemes) window.updateAllChartThemes();
            }
        },300);
    }
});
let toleranceMap={}; try{toleranceMap=JSON.parse(document.getElementById('toleranceJson')?.textContent||'{}');}catch(_){toleranceMap={};}
function aliasIndexFrom(map){const idx={}; for(const k of Object.keys(map)){const rec=map[k]; idx[k.toLowerCase()]=rec; (rec.alias||[]).forEach(a=>idx[a.toLowerCase()]=rec);} return idx;}
let aliasIndex=aliasIndexFrom(toleranceMap);
const saveTol=document.getElementById('saveTolerance'); if(saveTol){saveTol.addEventListener('click',()=>{try{toleranceMap=JSON.parse(document.getElementById('toleranceJson').textContent); aliasIndex=aliasIndexFrom(toleranceMap); alert('Tolerance map updated.');}catch(_){alert('Invalid JSON.');}});}

// --- ENHANCED & TROUBLESHOOTED ANIMAL VOICE STRESS DETECTOR ---
const analyzeSoundBtn = document.getElementById('analyzeSoundBtn');
if (analyzeSoundBtn) {
    let analysisInterval = null;

    const runAnalysis = (file) => {
        const resultOut = document.getElementById('voiceAnalysisResult');
        const animationFrames = ['[|]', '[/]', '[-]', '[\\]'];
        let frame = 0;

        resultOut.textContent = `Initializing analysis for "${file.name}"...`;

        // Start animation
        analysisInterval = setInterval(() => {
            frame = (frame + 1) % animationFrames.length;
            resultOut.textContent = `Analyzing audio signature... ${animationFrames[frame]}`;
        }, 200);

        setTimeout(() => {
            clearInterval(analysisInterval); // Stop animation
            
            const stringToHash = (s) => s.split('').reduce((a, b) => ((a << 5) - a + b.charCodeAt(0)) | 0, 0);
            const seed = Math.abs(stringToHash(file.name) + file.size + file.lastModified + stringToHash(file.type));

            const createSeededRandom = (s) => () => { s = Math.sin(s) * 10000; return s - Math.floor(s); };
            const seededRandom = createSeededRandom(seed);

            const fname = file.name.toLowerCase();
            let stressBias = 0;
            let detectedKeyword = null;

            const keywords = { 'distress': 0.4, 'pain': 0.45, 'fear': 0.35, 'angry': 0.3, 'aggressive': 0.3, 'calm': -0.3, 'song': -0.4, 'peaceful': -0.35, 'mating_call': 0.1, 'call': 0.05 };
            for(const key in keywords){ if(fname.includes(key)){ stressBias = keywords[key]; detectedKeyword = key; break; } }

            let baseProb = seededRandom() * 0.7 + 0.15;
            let finalProb = Math.max(0, Math.min(99, (baseProb + stressBias) * 100));

            let prediction = 'Low Distress';
            if (finalProb > 75) prediction = 'Critical Stress / Pain Detected';
            else if (finalProb > 55) prediction = 'High Agitation / Fear Response';
            else if (finalProb > 30) prediction = 'Moderate Stress or Alertness';

            let fidelity = (file.type === 'audio/wav' || file.type === 'audio/flac') ? "High-Fidelity (Lossless)" : "Standard Fidelity";
            
            let report = `Analysis Complete for "${file.name}"\n\n`;
            report += `Fidelity: ${fidelity} Analysis\n`;
            if (detectedKeyword) { report += `Context: Filename keyword "${detectedKeyword}" detected, influencing assessment.\n`; }
            report += `------------------------------------\n`;
            report += `Overall Assessment: [ ${prediction} ]\n`;
            report += `Stress Probability: ${finalProb.toFixed(1)}%\n\n`;
            report += `Vocal Biomarker Analysis:\n`;
            report += `  - Pitch Variation (Jitter):   ${(seededRandom() * 20 + 5).toFixed(2)}%\n`;
            report += `  - Freq. Modulation (Shimmer): ${(seededRandom() * 15 + 2).toFixed(2)} Hz\n`;
            report += `  - Harmonic-to-Noise Ratio:    ${(15 - seededRandom() * 10).toFixed(2)} dB\n`;
            report += `  - Vocal Tremor Index:         ${(seededRandom() * 0.8 + 0.1).toFixed(3)}\n\n`;
            report += `Note: This simulation provides a deterministic analysis based on file metadata.`;
            
            resultOut.textContent = report;

        }, 500);
    };

    analyzeSoundBtn.addEventListener('click', () => {
        const fileInput = document.getElementById('animalSoundUpload');
        if (analysisInterval) clearInterval(analysisInterval);

        if (fileInput.files.length === 0) {
            document.getElementById('voiceAnalysisResult').textContent = 'Please select an audio file first.';
            return;
        }
        runAnalysis(fileInput.files[0]);
    });
}


function createExtinctionChart(species, years, data) {
    const ctx = document.getElementById('extinctionChart');
    if (!ctx) return;
    if (chartInstances.extinction) {
        chartInstances.extinction.destroy();
    }
    const gradient = ctx.getContext('2d').createLinearGradient(0, 0, 0, 320);
    gradient.addColorStop(0, 'rgba(102, 227, 196, 0.4)');
    gradient.addColorStop(1, 'rgba(255, 107, 107, 0.3)');

    chartInstances.extinction = new Chart(ctx, {
        type: 'line',
        data: {
            labels: years,
            datasets: [{
                label: `Survivability Index for ${species}`,
                data: data,
                borderColor: '#ff9966',
                backgroundColor: gradient,
                borderWidth: 3,
                fill: true,
                tension: 0.4,
                pointRadius: 5,
                pointHoverRadius: 8,
                pointBackgroundColor: '#ff9966',
                pointBorderColor: '#fff',
                pointBorderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: { duration: 0 },
            interaction: { mode: 'index', intersect: false },
            plugins: {
                legend: { display: true, labels: { color: '#e8ecf1', font: { size: 14 } } },
                tooltip: {
                    backgroundColor: '#0f1523',
                    titleColor: '#e8ecf1',
                    bodyColor: '#9aa3ad',
                    borderColor: '#2a3145',
                    borderWidth: 1,
                    padding: 12,
                    callbacks: {
                        label: (context) => `Survivability: ${context.parsed.y.toFixed(1)}%`
                    }
                }
            },
            scales: {
                y: {
                    title: { display: true, text: 'Survivability Index (%)', color: '#9aa3ad' },
                    grid: { color: 'rgba(154,163,173, 0.15)' },
                    ticks: { color: '#9aa3ad' },
                    min: 0,
                    max: 100
                },
                x: {
                    title: { display: true, text: 'Year', color: '#9aa3ad' },
                    grid: { color: 'rgba(154,163,173, 0.1)' },
                    ticks: { color: '#9aa3ad' }
                }
            }
        }
    });
}

// --- DNA HABITAT VISUALIZER SCRIPT ---
let habitatMapInstance = null;
let currentHabitatLayer = null;
let lastAnalyzedProfile = null;
let lastSeededRandom = () => Math.random();

const dnaResultOut = document.getElementById('dnaResult');
const viewCurrentBtn = document.getElementById('dnaViewCurrent');
const viewFutureBtn = document.getElementById('dnaViewFuture');

const geneticTraits = {
    cryo: { name: 'Cryo-Adaptation', gene: 'CRY-73A', description: 'Survival in sub-zero temperatures.', color: '#7aa7ff', keywords: { arctic: 0.5, polar: 0.5, snow: 0.4, siberian: 0.4, tundra: 0.4, penguin: 0.3, leopard: 0.2 }, base: 0.05 },
    thermo: { name: 'Thermo-Regulation', gene: 'HSP-9B', description: 'Efficient heat dissipation in arid climates.', color: '#ff9966', keywords: { desert: 0.5, sahara: 0.5, camel: 0.4, tortoise: 0.3, savanna: 0.3, gobi: 0.4 }, base: 0.1 },
    hydro: { name: 'Hydro-Resilience', gene: 'AQUA-4', description: 'Adaptation to high-humidity/aquatic environments.', color: '#66e3c4', keywords: { river: 0.5, amphibian: 0.5, frog: 0.4, rainforest: 0.4, jungle: 0.4, swamp: 0.4, amazon: 0.5, dolphin: 0.4, whale: 0.4 }, base: 0.1 },
    generalist: { name: 'Generalist Adaptability', gene: 'GEN-ADAPT', description: 'Broad environmental tolerance.', color: '#cccccc', keywords: { forest: 0.2, deer: 0.2, bear: 0.2, wolf: 0.2, fox: 0.2, common: 0.2, brown: 0.1, grey: 0.1 }, base: 0.3 }
};

const habitatZones = {
    cryo: [ [[70,-160],[85,-50]], [[65,60],[80,170]], [[-70,-100],[-90,20]], [[30,80],[40,100]], [[60,-30],[75,30]] ],
    thermo: [ [[15,-110],[30,-80]], [[-20,10],[-35,40]], [[20,20],[30,60]], [[-30,110],[-15,140]], [[18, 60],[30,80]] ],
    hydro: [ [[-15,-70],[5,-45]], [[-5,10],[10,35]], [[-10,95],[10,140]], [[5, 65],[20,90]], [[-20, 110], [-5, 125]] ],
    generalist: [ [[35,-120],[50,-75]], [[40,0],[55,40]], [[-40,115],[-20,150]], [[30,80],[50,130]], [[30,-100],[50,-80]] ]
};

const analyzeGenomicProfile = (speciesName) => {
    const name = speciesName.toLowerCase();
    let profile = { scores: {}, justifications: [] };

    for (const traitId in geneticTraits) {
        const trait = geneticTraits[traitId];
        let score = trait.base;
        for (const keyword in trait.keywords) {
            if (name.includes(keyword)) {
                score += trait.keywords[keyword];
                profile.justifications.push({ keyword, trait: trait.name });
            }
        }
        profile.scores[traitId] = score;
    }

    const totalScore = Object.values(profile.scores).reduce((sum, score) => sum + score, 0);
    if (totalScore > 0) {
        for (const traitId in profile.scores) {
            profile.scores[traitId] = (profile.scores[traitId] / totalScore) * 100;
        }
    }
    return profile;
};

const drawHabitatZones = (profile, isFuture = false, seededRandom) => {
    const map = window.maps['habitat'];
    if (!map) return;
    if (currentHabitatLayer) map.removeLayer(currentHabitatLayer);
    
    const layers = [];
    const sortedTraits = Object.entries(profile.scores).sort((a, b) => b[1] - a[1]);
    const primaryTrait = sortedTraits[0][0];
    const secondaryTrait = sortedTraits[1][0];
    
    const pickZones = (trait, count) => {
        const allZones = habitatZones[trait];
        const shuffled = [...allZones].sort(() => 0.5 - seededRandom());
        return shuffled.slice(0, count);
    };

    const primaryZones = pickZones(primaryTrait, 1 + Math.floor(seededRandom() * 2));
    const secondaryZones = (profile.scores[secondaryTrait] > 25) ? pickZones(secondaryTrait, 1) : [];

    [...primaryZones, ...secondaryZones].forEach((bounds, index) => {
        let [[lat1, lon1], [lat2, lon2]] = bounds;
        const trait = (index < primaryZones.length) ? primaryTrait : secondaryTrait;
        
        if (isFuture) {
            if (trait === 'cryo') { lat1 += 5; lon1 +=3; lat2 -= 5; lon2 -=3; } // Shrink and shift
            if (trait === 'thermo') { lat1 -= 3; lon1 -=3; lat2 += 3; lon2 +=3; } // Expand
            if (trait === 'hydro') { lat1 +=2; lon1 += 4; lat2 -=2; lon2 -= 4; } // Fragment and shift
            if (trait === 'generalist') { lat1 += 2; lon2 -=2; } // Shift north
        }
        
        layers.push(L.rectangle([[lat1, lon1], [lat2, lon2]], {
            color: geneticTraits[trait].color, weight: 2, fillOpacity: 0.4
        }));
    });
    
    currentHabitatLayer = L.layerGroup(layers);
    currentHabitatLayer.addTo(map);
};

const updateDnaText = (species, profile, isFuture) => {
    const sortedTraits = Object.entries(profile.scores).sort((a, b) => b[1] - a[1]);
    
    let justification = profile.justifications.length > 0
        ? `Analysis of name suggests adaptation. Found keywords: ${profile.justifications.map(j => `'${j.keyword}'`).join(', ')}.`
        : 'No specific keywords found; assuming a generalist profile.';

    let summary = isFuture
        ? `Under the 2050 climate projection, suitable habitats are expected to shift significantly.`
        : `The species' genomic profile indicates a strong adaptation to its primary habitat conditions.`;
    
    dnaResultOut.innerHTML = `
        <div class="info-box">
            <h5>Genomic Profile</h5>
            <ul class="trait-list">
                ${sortedTraits.map(([id, score]) => `
                    <li class="trait-item">
                        <div class="trait-name">
                            <span>${geneticTraits[id].name}</span>
                            <span class="trait-score">${score.toFixed(1)}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${score.toFixed(1)}%; background-color: ${geneticTraits[id].color};"></div>
                        </div>
                    </li>
                `).join('')}
            </ul>
            <div class="dna-summary">
                <p><strong>Basis:</strong> ${justification}</p>
                <p><strong>Analysis (${isFuture ? '2050' : 'Current'}):</strong> ${summary}</p>
            </div>
        </div>`;
};


if(viewCurrentBtn) {
    viewCurrentBtn.addEventListener('click', () => {
        if (!lastAnalyzedProfile) return;
        const species = document.getElementById('unifiedSpeciesQuery').value.trim();
        drawHabitatZones(lastAnalyzedProfile, false, lastSeededRandom);
        updateDnaText(species, lastAnalyzedProfile, false);
        viewCurrentBtn.classList.add('primary');
        viewFutureBtn.classList.remove('primary');
    });
}

if(viewFutureBtn) {
    viewFutureBtn.addEventListener('click', () => {
        if (!lastAnalyzedProfile) return;
        const species = document.getElementById('unifiedSpeciesQuery').value.trim();
        drawHabitatZones(lastAnalyzedProfile, true, lastSeededRandom);
        updateDnaText(species, lastAnalyzedProfile, true);
        viewFutureBtn.classList.add('primary');
        viewCurrentBtn.classList.remove('primary');
    });
}

</script>

<script>
(function(){
  const mount=document.getElementById('globeMount'), hud=document.getElementById('earthHud');
  if(!mount) return;
  const canvas=document.createElement('canvas'); canvas.style.width='100%'; canvas.style.height='100%'; canvas.style.display='block'; mount.appendChild(canvas);
  function startPainter(img){ const ctx=canvas.getContext('2d'); function loop(){ const w=canvas.width=mount.clientWidth||800, h=canvas.height=mount.clientHeight||520; ctx.clearRect(0,0,w,h); ctx.fillStyle='#02040a'; ctx.fillRect(0,0,w,h); const r=Math.min(w,h)*0.38, cx=w/2, cy=h/2; const grad=ctx.createRadialGradient(cx-r*0.4,cy-r*0.4,r*0.2,cx,cy,r*1.1); grad.addColorStop(0,'rgba(255,255,255,0.12)'); grad.addColorStop(1,'rgba(0,0,0,0.7)'); ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.closePath(); ctx.fillStyle=grad; ctx.fill(); ctx.save(); ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.clip(); const t=Date.now()*0.00003, imgW=img.width, imgH=img.height, sx=Math.floor((imgW*t)%imgW); ctx.drawImage(img,sx,0,imgW-sx,imgH,cx-r,cy-r,(imgW-sx)*(2*r/imgH),2*r); if(sx>0){ ctx.drawImage(img,0,0,sx,imgH,cx-r+(imgW-sx)*(2*r/imgH),cy-r,sx*(2*r/imgH),2*r); } ctx.restore(); const gloss=ctx.createRadialGradient(cx-r*0.6,cy-r*0.6,1,cx-r*0.6,cy-r*0.6,r*1.2); gloss.addColorStop(0,'rgba(255,255,255,0.08)'); gloss.addColorStop(1,'rgba(255,255,255,0)'); ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.closePath(); ctx.fillStyle=gloss; ctx.fill(); requestAnimationFrame(loop); } loop(); if(hud) hud.textContent='Globe: rotating Earth view'; }
  const dayImg=new Image(); dayImg.onload=()=>startPainter(dayImg);
  dayImg.onerror=()=>{ canvas.style.background="radial-gradient(closest-side at 50% 50%, #2b3b6d 0%, #0d1220 60%)"; if(hud) hud.textContent='Globe: day.jpg missing at /assets/earth/day.jpg'; };
  dayImg.src='/assets/earth/day.jpg';
})();
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
<script>
// =========================================================
// =================== NASA GIBS MANAGER ===================
// =========================================================
window.maps = window.maps || {}; // To hold all map instances
const GIBS = {
    date: new Date(new Date().setDate(new Date().getDate() - 1)).toISOString().split('T')[0], // YYYY-MM-DD for yesterday
    layers: {
        // Base Layers
        "True Color (Terra)": { name: "MODIS_Terra_CorrectedReflectance_TrueColor", format: "jpg" },
        "True Color (Aqua)": { name: "MODIS_Aqua_CorrectedReflectance_TrueColor", format: "jpg" },
        // Overlays
        "Active Fires": { name: "VIIRS_NOAA20_ActiveFires_375m_Day", format: "png" },
        "Sea Surface Temp": { name: "GHRSST_L4_MUR_Sea_Surface_Temperature", format: "png" },
        "Sea Ice Concentration": { name: "AMSR2_Sea_Ice_Concentration_12km", format: "png" },
        "Vegetation (NDVI)": { name: "MODIS_Terra_NDVI", format: "png"},
    },

    createLayer: function(layerKey, dateString) {
        const layerInfo = this.layers[layerKey];
        if (!layerInfo) return null;
        const tmpl = `//gibs.earthdata.nasa.gov/wmts/epsg3857/best/${layerInfo.name}/default/${dateString}/GoogleMapsCompatible_Level9/{z}/{y}/{x}.${layerInfo.format}`;
        return L.tileLayer(tmpl, {
            attribution: `NASA GIBS`,
            maxNativeZoom: 9,
            opacity: 0.8
        });
    }
};

function initializeMap(mapId, view, zoom, baseTileUrl, baseTileOptions) {
    if (window.maps[mapId] && window.maps[mapId].getCenter) { // Check if it's a Leaflet map object
        setTimeout(() => window.maps[mapId].invalidateSize(), 100);
        return window.maps[mapId];
    }
    
    const map = L.map(mapId).setView(view, zoom);
    L.tileLayer(baseTileUrl, baseTileOptions).addTo(map);
    
    window.maps[mapId] = map;

    setTimeout(() => map.invalidateSize(), 100);

    return map;
}

function initializeDisasterMap() {
    const mapId = 'disaster-map';
    const map = initializeMap(mapId, [20, 0], 2, 'https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; CARTO'
    });
    window.maps['disasters'] = map; 

    const controlContainer = document.getElementById('gibs-layer-control');
    if (!controlContainer || controlContainer.dataset.initialized) return;
    controlContainer.dataset.initialized = 'true';

    controlContainer.innerHTML = `
        <div class="control-group">
            <label for="gibs-date">Date:</label>
            <input type="date" id="gibs-date" value="${GIBS.date}">
        </div>
        <div class="control-group">
            <label>Base Layer:</label>
            <input type="radio" name="base-layer" value="True Color (Terra)" id="base-terra" checked> <label for="base-terra">Terra</label>
            <input type="radio" name="base-layer" value="True Color (Aqua)" id="base-aqua"> <label for="base-aqua">Aqua</label>
        </div>
        <div class="control-group">
            <label>Overlays:</label>
            <input type="checkbox" id="overlay-fires" value="Active Fires"> <label for="overlay-fires">ðŸ”¥ Fires</label>
            <input type="checkbox" id="overlay-sst" value="Sea Surface Temp"> <label for="overlay-sst">ðŸŒ¡ï¸ SST</label>
        </div>`;
    
    let baseLayers = {};
    let overlayLayers = {};

    const updateMap = () => {
        const date = document.getElementById('gibs-date').value;
        const baseLayerChoice = document.querySelector('input[name="base-layer"]:checked').value;

        Object.values(baseLayers).forEach(layer => { if(layer) map.removeLayer(layer); });
        baseLayers[baseLayerChoice] = GIBS.createLayer(baseLayerChoice, date);
        if(baseLayers[baseLayerChoice]) baseLayers[baseLayerChoice].addTo(map);

        document.querySelectorAll('input[type="checkbox"]').forEach(box => {
            const layerKey = box.value;
            if (overlayLayers[layerKey]) map.removeLayer(overlayLayers[layerKey]);
            
            if (box.checked) {
                overlayLayers[layerKey] = GIBS.createLayer(layerKey, date);
                if(overlayLayers[layerKey]) overlayLayers[layerKey].addTo(map);
            }
        });
    };

    controlContainer.addEventListener('change', updateMap);
    updateMap();
}

function connectEnvMapSearch() {
    // This function connects the search bar to the Google Maps iframe.
    // It uses a flag to ensure it only runs once.
    if (window.maps['environment_search_connected']) {
        return;
    }

    const searchBtn = document.getElementById('searchEnvMap');
    const queryInput = document.getElementById('envMapQuery');
    const statusEl = document.getElementById('envMapStatus');
    const mapIframe = document.getElementById('env-map-iframe');

    const fireBtn = document.getElementById('overlay-fire');
    const windBtn = document.getElementById('overlay-wind');
    const airBtn = document.getElementById('overlay-air');
    const clearBtn = document.getElementById('overlay-clear');
    const overlayBtns = [fireBtn, windBtn, airBtn];

    let activeOverlay = null;
    let lastQuery = "";

    if (!searchBtn || !queryInput || !statusEl || !mapIframe || !fireBtn) {
        return; 
    }

    const performSearch = () => {
        const query = queryInput.value.trim();
        if (query) {
            lastQuery = query;
        }

        if (!lastQuery) {
             statusEl.textContent = "Please enter a location to search.";
            return;
        }
        
        let finalQuery = lastQuery;
        let statusText = `Showing results for: "${lastQuery}"`;

        if (activeOverlay) {
            finalQuery = `${activeOverlay.text} ${lastQuery}`;
            statusText = `Showing ${activeOverlay.name} for: "${lastQuery}"`;
        }

        statusEl.textContent = `Searching for "${finalQuery}"...`;
        
        const embedUrl = `https://maps.google.com/maps?q=${encodeURIComponent(finalQuery)}&t=m&z=8&ie=UTF8&iwloc=&output=embed`;
        
        mapIframe.src = embedUrl;

        mapIframe.onload = () => {
             statusEl.textContent = statusText;
        };
    };

    const setActiveOverlay = (overlay) => {
        activeOverlay = overlay;
        overlayBtns.forEach(btn => btn.classList.remove('primary'));
        if (overlay) {
            if (overlay.text.includes('fire')) fireBtn.classList.add('primary');
            else if (overlay.text.includes('wind')) windBtn.classList.add('primary');
            else if (overlay.text.includes('air')) airBtn.classList.add('primary');
        }
        performSearch();
    };

    searchBtn.addEventListener('click', performSearch);
    queryInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            e.preventDefault();
            performSearch();
        }
    });

    fireBtn.addEventListener('click', () => setActiveOverlay({ text: "fire hazard map for", name: "Fire Hazard" }));
    windBtn.addEventListener('click', () => setActiveOverlay({ text: "wind speed map for", name: "Wind Speed" }));
    airBtn.addEventListener('click', () => setActiveOverlay({ text: "air quality map for", name: "Air Quality" }));
    clearBtn.addEventListener('click', () => setActiveOverlay(null));

    window.maps['environment_search_connected'] = true;
}


// --- TIME MIRROR SCRIPT ---
const timeMirrorDatabase = {
    "sundarbans": {
        name: "Sundarbans, India",
        coords: [22.2, 88.8],
        zoom: 8,
        baseDate: "2024-01-01",
        images: {
            2025: 'https://storage.googleapis.com/gemini-generative-ai-docs/images/sundarbans_2025.jpeg',
            2050: 'https://storage.googleapis.com/gemini-generative-ai-docs/images/sundarbans_2050.jpeg',
            2100: 'https://storage.googleapis.com/gemini-generative-ai-docs/images/sundarbans_2100.jpeg'
        },
        changes: {
            tempIncreaseFactor: 3.5,
            seaRiseFactor: 1.5,
            vegetationType: 'Mangrove',
            vegetationBounds: [[21.5, 88.0], [23.5, 89.0]],
            floodBounds: [[21.5, 88.0], [21.5, 89.0]],
            floodProgressFactor: 0.5
        },
        species: [
            { name: 'Bengal Tiger', declineThreshold: 0.7 },
            { name: 'Saltwater Crocodile', thriveThreshold: 0.4 },
            { name: 'Spotted Deer', declineThreshold: 0.8 },
            { name: 'Mangrove Pitta', status: 'Declining' },
            { name: 'Jellyfish', status: 'Thriving' }
        ]
    },
    "arctic": {
        name: "Arctic Tundra, Svalbard",
        coords: [78.2, 15.6],
        zoom: 6,
        baseDate: "2023-07-15",
        images: {
            2025: 'https://images.unsplash.com/photo-1531310156540-62e910537248?q=80&w=1974',
            2050: 'https://images.unsplash.com/photo-1590326941882-276632c252ab?q=80&w=2070',
            2100: 'https://images.unsplash.com/photo-1549642392-80c14b75225f?q=80&w=2070'
        },
        changes: {
            tempIncreaseFactor: 4.5,
            seaRiseFactor: 1.2,
            vegetationType: 'Permafrost',
            vegetationBounds: [[77, 10], [80, 25]],
            floodBounds: null, 
        },
        species: [
            { name: 'Polar Bear', declineThreshold: 0.3 },
            { name: 'Arctic Fox', declineThreshold: 0.5 },
            { name: 'Svalbard Reindeer', thriveThreshold: 0.6 },
            { name: 'Puffin', status: 'Declining' },
            { name: 'Seals', status: 'Stable' }
        ]
    },
    "amazon": {
        name: "Amazon Rainforest, Brazil",
        coords: [-3.46, -62.21],
        zoom: 7,
        baseDate: "2023-08-20",
        images: {
            2025: 'https://images.unsplash.com/photo-1547634233-f73a3838232c?q=80&w=2070',
            2050: 'https://images.unsplash.com/photo-1589519128945-23d4d3a778c8?q=80&w=2070',
            2100: 'https://images.unsplash.com/photo-1560862214-7cef421804d9?q=80&w=2070'
        },
        changes: {
            tempIncreaseFactor: 4.0,
            seaRiseFactor: 0,
            vegetationType: 'Rainforest',
            vegetationBounds: [[-5, -64], [-2, -60]],
            floodBounds: null,
        },
        species: [
            { name: 'Jaguar', declineThreshold: 0.6 },
            { name: 'Macaw', declineThreshold: 0.8 },
            { name: 'Capybara', status: 'Stable' },
            { name: 'Poison Dart Frog', declineThreshold: 0.5 },
            { name: 'Termites', status: 'Thriving' }
        ]
    }
};

let timeMirrorMapLayers = {};
let currentMirrorLocation = timeMirrorDatabase.sundarbans;

function initializeTimeMirror() {
    const mapId = 'simulation-map';
    const defaultLocation = timeMirrorDatabase.sundarbans;
    currentMirrorLocation = defaultLocation;

    const map = initializeMap(mapId, defaultLocation.coords, defaultLocation.zoom, 'https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; CARTO'
    });
    window.maps['time-mirror'] = map;

    if (timeMirrorMapLayers.gibs) map.removeLayer(timeMirrorMapLayers.gibs);
    timeMirrorMapLayers.gibs = GIBS.createLayer("True Color (Terra)", defaultLocation.baseDate);
    if(timeMirrorMapLayers.gibs) timeMirrorMapLayers.gibs.addTo(map);
    
    runTimeMirrorSimulation(2025, defaultLocation);
}

function runTimeMirrorSimulation(year, locationData) {
    const summaryEl = document.getElementById('summary-content');
    const speciesEl = document.getElementById('species-content');
    const imageEl = document.getElementById('simulation-image');

    if (!locationData) {
        summaryEl.innerHTML = `<p style="color:var(--danger)">Location not found in database. Try "Sundarbans", "Arctic", or "Amazon".</p>`;
        speciesEl.innerHTML = '...';
        return;
    }

    const map = window.maps['time-mirror'];
    if (!map) return;

    const { changes, species, images } = locationData;
    const baseYear = 2025;
    const maxYear = 2100;
    const progress = (year - baseYear) / (maxYear - baseYear);

    // Map Layers
    if(timeMirrorMapLayers.gibs) timeMirrorMapLayers.gibs.setOpacity(Math.max(0, 1 - progress * 1.5));

    if (timeMirrorMapLayers.change) map.removeLayer(timeMirrorMapLayers.change);
    const changeColor = changes.vegetationType === 'Mangrove' ? `rgba(102, 227, 196, ${0.6 - progress * 0.4})` : `rgba(255, 107, 107, ${0.6 - progress * 0.4})`;
    timeMirrorMapLayers.change = L.rectangle(changes.vegetationBounds, { color: changeColor, weight: 0, fillOpacity: progress * 0.3 });
    timeMirrorMapLayers.change.addTo(map);

    if (timeMirrorMapLayers.flood) map.removeLayer(timeMirrorMapLayers.flood);
    if (changes.floodBounds && progress > 0.1) {
        const floodColor = `rgba(122, 167, 255, 0.7)`;
        const [start, end] = changes.floodBounds;
        const floodedBounds = [start, [start[0] + (progress * changes.floodProgressFactor), end[1]]];
        timeMirrorMapLayers.flood = L.rectangle(floodedBounds, { color: floodColor, weight: 0, fillOpacity: progress * 0.4 });
        timeMirrorMapLayers.flood.addTo(map);
    }
    
    // Text Content
    const tempIncrease = (progress * changes.tempIncreaseFactor).toFixed(1);
    const seaRise = (progress * changes.seaRiseFactor).toFixed(2);
    summaryEl.innerHTML = `<ul style="list-style: 'ðŸŒ¡ï¸ '; padding-left: 20px;"><li>Avg. Temperature: <strong style="color:var(--danger)">+${tempIncrease}Â°C</strong></li>${changes.seaRiseFactor > 0 ? `<li style="list-style: 'ðŸ’§ ';">Sea Level Rise: <strong style="color:var(--accent2)">+${seaRise}m</strong></li>` : ''}<li style="list-style: 'ðŸŒ¿ ';">${changes.vegetationType} Health: <strong style="color:${progress > 0.6 ? 'var(--danger)' : 'var(--accent)'}">${progress > 0.6 ? 'Stressed' : 'Stable'}</strong></li></ul>`;

    const speciesList = species.map(s => {
        let status = s.status || 'Stable';
        if (s.declineThreshold && progress > s.declineThreshold) status = 'Declining';
        if (s.thriveThreshold && progress > s.thriveThreshold) status = 'Thriving';
        return { name: s.name, status: status };
    });
    speciesEl.innerHTML = `<ul>${speciesList.map(s => `<li>${s.name} - <span class="status-${s.status.toLowerCase()}">${s.status}</span></li>`).join('')}</ul>`;

    // Image
    let imageUrl = images[2025];
    if (year >= 2080) imageUrl = images[2100];
    else if (year >= 2050) imageUrl = images[2050];
    imageEl.src = imageUrl;
}

function handleTimeMirrorSearch() {
    const query = document.getElementById('timeMirrorLocation').value.toLowerCase();
    const map = window.maps['time-mirror'];
    
    let foundKey = null;
    for (const key in timeMirrorDatabase) {
        if (query.includes(key)) {
            foundKey = key;
            break;
        }
    }

    const year = document.getElementById('time-slider').value;
    if (foundKey) {
        currentMirrorLocation = timeMirrorDatabase[foundKey];
        document.getElementById('timeMirrorLocation').value = currentMirrorLocation.name;
        
        if (map) {
            map.setView(currentMirrorLocation.coords, currentMirrorLocation.zoom);
            if(timeMirrorMapLayers.gibs) map.removeLayer(timeMirrorMapLayers.gibs);
            timeMirrorMapLayers.gibs = GIBS.createLayer("True Color (Terra)", currentMirrorLocation.baseDate);
            if(timeMirrorMapLayers.gibs) timeMirrorMapLayers.gibs.addTo(map);
        }
        
        runTimeMirrorSimulation(year, currentMirrorLocation);
    } else {
        runTimeMirrorSimulation(year, null);
    }
}


document.addEventListener('DOMContentLoaded', () => {
    const slider = document.getElementById('time-slider');
    const yearLabel = document.getElementById('slider-year-label');
    if (slider) {
        slider.addEventListener('input', () => {
            const year = slider.value;
            if (yearLabel) yearLabel.textContent = year;
            runTimeMirrorSimulation(year, currentMirrorLocation);
        });
    }

    const searchBtn = document.getElementById('runTimeMirrorSearch');
    if (searchBtn) {
        searchBtn.addEventListener('click', handleTimeMirrorSearch);
    }

    const searchInput = document.getElementById('timeMirrorLocation');
    if (searchInput) {
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleTimeMirrorSearch();
            }
        });
    }
});
</script>


</body></html>
